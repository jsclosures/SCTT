{"testname":"default","comments":"default","testsample":"default","testnotes":"YmFzZQ==","testdetailscript":"ZnVuY3Rpb24oY29tbWFuZExpbmUsY2FsbGJhY2spewoKdmFyIHNvbHJIb3N0ID0gQ09OVEVYVC5TT0xSSE9TVDsKICAgICAgICB2YXIgc29sclBvcnQgPSBDT05URVhULlNPTFJQT1JUOwogICAgICAgIHZhciBzb2xyUGF0aCA9ICIvc29sci92YWxpZGF0ZS9zZWxlY3Q/cT0qOioiOwogICAgICAgIAogICAgICAgIGxldCB0ZXN0TmFtZSA9ICJkZWZhdWx0IjsgCgogICAgICAgIGlmKCBjb21tYW5kTGluZS50ZXN0bmFtZSApCiAgICAgICAgICAgIHRlc3ROYW1lID0gYXJncy5xdWVyeU9iai50ZXN0bmFtZTsKICAgICAgICAKICAgICAgICBpZiggdGVzdE5hbWUgKXsKICAgICAgICAgICAgc29sclBhdGggKz0gIiZmcT10ZXN0bmFtZToiICsgdGVzdE5hbWU7CiAgICAgICAgfQogICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHtpdGVtczogW119OwoKICAgICAgICB2YXIgY29sbGVjdG9yQ0IgPSBmdW5jdGlvbihkYXRhKXsKICAgICAgICAgICAgaWYoIGRhdGEuaXRlbXMgKXsKICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0Lml0ZW1zID0gdGhpcy5yZXN1bHQuaXRlbXMuY29uY2F0KGRhdGEuaXRlbXMpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coImNvbmNhdCBpdGVtcyIsdGhpcy5yZXN1bHQsdGhpcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCB0aGlzLm5leHRFbnRyeSApCiAgICAgICAgICAgICAgICBDT05URVhULmxpYi5nZXRSRVNURGF0YSh7aG9zdDogc29sckhvc3QscG9ydDogc29sclBvcnQscGF0aDogdGhpcy5uZXh0RW50cnkucGF0aCx0eXBlOiB0aGlzLm5leHRFbnRyeS50eXBlLGNhbGxiYWNrOiB0aGlzLm5leHRFbnRyeS5jYWxsYmFjayxlbnRyeTogdGhpcy5uZXh0RW50cnl9KTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFjayh0aGlzLnJlc3VsdCk7CiAgICAgICAgfQogICAgICAgIHZhciBwYXRoTGlzdCA9IFsKICAgICAgICAgICAgICAgICAgICAgICAge3R5cGU6ICJxdWVyeSIsbGFiZWw6ICJTdW1tYXJ5TWF4UVRpbWVzIixmaWVsZDogInF0aW1lIixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6U1VNTUFSWSZyb3dzPTEmc29ydD1xdGltZStkZXNjIn0sCiAgICAgICAgICAgICAgICAgICAgICAgIHt0eXBlOiAicXVlcnkiLGxhYmVsOiAiU3VtbWFyeU1heFJvd0NvdW50IixmaWVsZDogInJvd2NvdW50IixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6U1VNTUFSWSZyb3dzPTEmc29ydD1yb3djb3VudCtkZXNjIn0sCiAgICAgICAgICAgICAgICAgICAgICAgIHt0eXBlOiAicXVlcnkiLGxhYmVsOiAiU3VtbWFyeU1pblFUaW1lIixmaWVsZDogInF0aW1lIixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6U1VNTUFSWSZyb3dzPTEmc29ydD1xdGltZSthc2MifSwKICAgICAgICAgICAgICAgICAgICAgICAge3R5cGU6ICJxdWVyeSIsbGFiZWw6ICJTdW1tYXJ5TWluUm93Q291bnQiLGZpZWxkOiAicm93Y291bnQiLHBhdGg6IHNvbHJQYXRoICsgIiZmcT1jb250ZW50dHlwZTpTVU1NQVJZJnJvd3M9MSZzb3J0PXJvd2NvdW50K2FzYyJ9LAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAge3R5cGU6ICJxdWVyeSIsbGFiZWw6ICJCZWZvcmVNYXhRVGltZSIsZmllbGQ6ICJxdGltZSIscGF0aDogc29sclBhdGggKyAiJmZxPWNvbnRlbnR0eXBlOkJFRk9SRSZyb3dzPTEmc29ydD1xdGltZStkZXNjIn0sCiAgICAgICAgICAgICAgICAgICAgICAgIHt0eXBlOiAicXVlcnkiLGxhYmVsOiAiQmVmb3JlTWF4Um93Q291bnQiLGZpZWxkOiAicm93Y291bnQiLHBhdGg6IHNvbHJQYXRoICsgIiZmcT1jb250ZW50dHlwZTpCRUZPUkUmcm93cz0xJnNvcnQ9cm93Y291bnQrZGVzYyJ9LAogICAgICAgICAgICAgICAgICAgICAgICB7dHlwZTogInF1ZXJ5IixsYWJlbDogIkFmdGVyTWF4UVRpbWUiLGZpZWxkOiAicXRpbWUiLHBhdGg6IHNvbHJQYXRoICsgIiZmcT1jb250ZW50dHlwZTpBRlRFUiZyb3dzPTEmc29ydD1xdGltZStkZXNjIn0sCiAgICAgICAgICAgICAgICAgICAgICAgIHt0eXBlOiAicXVlcnkiLGxhYmVsOiAiQWZ0ZXJNYXhSb3dDb3VudCIsZmllbGQ6ICJyb3djb3VudCIscGF0aDogc29sclBhdGggKyAiJmZxPWNvbnRlbnR0eXBlOkFGVEVSJnJvd3M9MSZzb3J0PXJvd2NvdW50K2Rlc2MifSwKICAgICAgICAgICAgICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgICAgICAgICB7dHlwZTogInF1ZXJ5IixsYWJlbDogIkJlZm9yZU1pblFUaW1lIixmaWVsZDogInF0aW1lIixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6QkVGT1JFJnJvd3M9MSZzb3J0PXF0aW1lK2FzYyJ9LAogICAgICAgICAgICAgICAgICAgICAgICB7dHlwZTogInF1ZXJ5IixsYWJlbDogIkJlZm9yZU1pblJvd0NvdW50IixmaWVsZDogInJvd2NvdW50IixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6QkVGT1JFJnJvd3M9MSZzb3J0PXJvd2NvdW50K2FzYyJ9LAogICAgICAgICAgICAgICAgICAgICAgICB7dHlwZTogInF1ZXJ5IixsYWJlbDogIkFmdGVyTWluUVRpbWUiLGZpZWxkOiAicXRpbWUiLHBhdGg6IHNvbHJQYXRoICsgIiZmcT1jb250ZW50dHlwZTpBRlRFUiZyb3dzPTEmc29ydD1xdGltZSthc2MifSwKICAgICAgICAgICAgICAgICAgICAgICAge3R5cGU6ICJxdWVyeSIsbGFiZWw6ICJBZnRlck1pblJvd0NvdW50IixmaWVsZDogInJvd2NvdW50IixwYXRoOiBzb2xyUGF0aCArICImZnE9Y29udGVudHR5cGU6QUZURVImcm93cz0xJnNvcnQ9cm93Y291bnQrYXNjIn0sCiAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHt0eXBlOiAiZmFjZXQiLHBhdGg6IHNvbHJQYXRoICsgIiZmYWNldC5maWVsZD1jb250ZW50dHlwZSZmYWNldD1vbiZmYWNldC5taW5jb3VudD0xJnJvd3M9MCJ9CiAgICAgICAgICAgICAgICAgICAgICAgIF07CiAgICAgICAgZm9yKGxldCBpID0gMDtpIDwgcGF0aExpc3QubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIGlmKCBpKzEgPCBwYXRoTGlzdC5sZW5ndGggKQogICAgICAgICAgICAgICAgcGF0aExpc3RbaV0uY2FsbGJhY2sgPSBjb2xsZWN0b3JDQi5iaW5kKHthcmdzOiBjb21tYW5kTGluZSxyZXN1bHQ6IGZpbmFsUmVzdWx0LG5leHRFbnRyeTogcGF0aExpc3RbaSsxXSxjYWxsYmFjazogY2FsbGJhY2sgfSk7CiAgICAgICAgICAgIGVsc2UgICAgCiAgICAgICAgICAgICAgICBwYXRoTGlzdFtpXS5jYWxsYmFjayA9IGNvbGxlY3RvckNCLmJpbmQoe2FyZ3M6IGNvbW1hbmRMaW5lLHJlc3VsdDogZmluYWxSZXN1bHQsY2FsbGJhY2s6IGNhbGxiYWNrIH0pOwogICAgICAgIH0KCiAgICAgICAgY29uc29sZS5sb2coInNvbHJwYXRoIixwYXRoTGlzdFswXS5wYXRoKTsKICAgICAgICBDT05URVhULmxpYi5nZXRSRVNURGF0YSh7aG9zdDogc29sckhvc3QscG9ydDogc29sclBvcnQscGF0aDogcGF0aExpc3RbMF0ucGF0aCx0eXBlOiBwYXRoTGlzdFswXS50eXBlLGNhbGxiYWNrOiBwYXRoTGlzdFswXS5jYWxsYmFjayxlbnRyeTogcGF0aExpc3RbMF19KTsKCgp9","testharvestscript":"ZnVuY3Rpb24oY29tbWFuZExpbmUpewpsZXQgY29uZmlnID0gewoJCQkgIGhvc3Q6ICdzb2xyc2VydmVyJywKCQkJICBwb3J0OiAyMiwKCQkJICB1c2VybmFtZTogY29tbWFuZExpbmUudXNlcm5hbWUsCgkJCSAgcGFzc3dvcmQ6IGNvbW1hbmRMaW5lLnBhc3N3b3JkCgkJCX07CgpmdW5jdGlvbiByZWRhY3Qob2JqLGZpZWxkTmFtZSl7CiAgbGV0IHJlc3VsdCA9ICcnOwoKZm9yKGxldCBwIGluIG9iail7CiAgIGlmKCBwICE9IGZpZWxkTmFtZSApewogICAgICAgIHJlc3VsdCArPSAiICIgKyBwICsgIjoiICsgb2JqW3BdOwogICB9Cn0KCgpyZXR1cm4oIHJlc3VsdCApOwp9CgpmdW5jdGlvbiB3cml0ZUxvZ0xpbmUob3V0U3RyZWFtLGxvZyl7CglvdXRTdHJlYW0ud3JpdGUobG9nICsgIlxuIik7Cn0KCmxldCBzaHV0RG93biA9IGZhbHNlOwpsZXQgc2h1dERvd25Db3VudGVyID0gMDsKZnVuY3Rpb24gY2hlY2tTaXplKGNsaWVudCxjYil7CglsZXQgc3RhdHMgPSBmcy5zdGF0U3luYyhjb21tYW5kTGluZS5vdXRGaWxlTmFtZSk7Cgljb25zb2xlLmxvZyhzdGF0cy5zaXplKTsKCXNodXREb3duQ291bnRlcisrOwoJaWYoIHN0YXRzLnNpemUgPj0gY29tbWFuZExpbmUubWF4U2l6ZSAgfHwgc2h1dERvd25Db3VudGVyID4gMjAwICl7CgkJaWYoIGNsaWVudCAmJiAhc2h1dERvd24pewoJCQlzaHV0RG93biA9IHRydWU7CgkJCWNiKCk7CgkJfQoJfQoJZWxzZSB7CgkJc2V0VGltZW91dChjaGVja1NpemUsNTAwMCxjbGllbnQsY2IpOwoJfQp9CgoKZnVuY3Rpb24gY29weUZpbGVGaXJzdChjb25maWcsY2FsbGJhY2spewogICAgbGV0IGZpbGVOYW1lSW4gPSAnL3dheWZhaXIvZGF0YS9zb2xyL3Zhci9sb2dzL3NvbHIubG9nJzsKICAgIGxldCBmaWxlTmFtZU91dCA9ICcvdG1wL3NvbHIubG9nJzsKICAgIGNvbnNvbGUubG9nKHJlZGFjdChjb25maWcsInBhc3N3b3JkIikpOwoJdmFyIGNvbm4gPSBuZXcgU1NIQ2xpZW50KCk7Cgljb25uLm9uKCdyZWFkeScsIGZ1bmN0aW9uKCkgewoJICAgIGNvbnNvbGUubG9nKCdDbGllbnQgOjogcmVhZHknKTsKCSAgICBjb25uLmV4ZWMoJ3N1ZG8gY2F0ICcgKyBmaWxlTmFtZUluICsgJyA+ICcgKyBmaWxlTmFtZU91dCwgeyBwdHk6IHRydWUgfSwgZnVuY3Rpb24oZXJyLCBzdHJlYW0pIHsKCSAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyOwoJICAgICAgICBzdHJlYW0ub24oJ2Nsb3NlJywgZnVuY3Rpb24oY29kZSwgc2lnbmFsKSB7CgkgICAgICAgICAgICBjb25zb2xlLmxvZygnU3RyZWFtIDo6IGNsb3NlIDo6IGNvZGU6ICcgKyBjb2RlICsgJywgc2lnbmFsOiAnICsgc2lnbmFsKTsKCSAgICAgICAgICAgIGNvbm4uZW5kKCk7CgkgICAgICAgICAgICBjYWxsYmFjayh7c3RhdHVzOiAxfSk7CgkgICAgICAgIH0pLm9uKCdkYXRhJywgZnVuY3Rpb24oZGF0YSkgewoJICAgICAgICAgICAgaWYgKGRhdGEuaW5kZXhPZignOicpID49IGRhdGEubGVuZ3RoIC0gMikgewoJICAgICAgICAgICAgc3RyZWFtLndyaXRlKGNvbmZpZy5wYXNzd29yZCArICdcbicpOwpjb25zb2xlLmxvZygic2V0dGluZyBwYXNzd29yZCIpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NURE9VVDogJyArIGRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2FsbGJhY2soe3N0YXR1czogMX0pOwoJICAgICAgICB9KS5zdGRlcnIub24oJ2RhdGEnLCBmdW5jdGlvbihkYXRhKSB7CgkgICAgICAgICAgICBjb25zb2xlLmxvZygnU1RERVJSOiAnICsgZGF0YSk7CgkgICAgICAgIH0pOwoJICAgIH0pOwoJfSkuY29ubmVjdChjb25maWcpOwp9CgpmdW5jdGlvbiBnZXRDb3JlTG9nQ2FsbGJhY2socmVzKSB7CglsZXQgc3RyID0gIiI7CiAgICBsZXQgb3V0RmlsZU5hbWUgPSB0aGlzLm91dEZpbGVOYW1lOwogICAgbGV0IG91dFN0cmVhbSA9IHRoaXMub3V0U3RyZWFtOwoJbGV0IGNhbGxiYWNrID0gdGhpcy5jYWxsYmFjazsKCWxldCBjb3JlTGlzdCA9IHRoaXMuY29yZUxpc3Q7CglsZXQgaW5kZXggPSB0aGlzLmluZGV4OwogICAgbGV0IGNsaWVudCA9IHRoaXMuY2xpZW50OwogICAgbGV0IGRldGFpbHMgPSB0aGlzLmRldGFpbHM7CgogICAgY29uc29sZS5sb2coImdldCIpOwogICAgbGV0IHJlbW90ZVBhdGggPSAnL3RtcC9zb2xyLmxvZyc7CgoJCQlsZXQgb3B0aW9ucyA9IHsKCQkJICBjb25jdXJyZW5jeTogNjQsIAoJCQkgIGF1dG9DbG9zZTogZmFsc2UsCgkJCSAgY2h1bmtTaXplOiAzMjc2OCwgCgkJCSAgc3RlcDogZnVuY3Rpb24odG90YWxfdHJhbnNmZXJyZWQsIGNodW5rLCB0b3RhbCkgewoJCQkgICAgY29uc29sZS5sb2codG90YWxfdHJhbnNmZXJyZWQsdG90YWwpOwoJCQkgIH0KCQkJfTsKICAgIGxldCBjYiA9IGZ1bmN0aW9uKCl7CiAgICAJdGhpcy5jbGllbnQuZW5kKCk7CiAgICAgICAgY29uc29sZS5sb2coImVuZCIpOwogICAgICAgIHRoaXMub3V0U3RyZWFtLmNsb3NlKCk7CiAgICAgICBjb25zb2xlLmxvZygiQ09SRUxPR1MiKTsKICAgICAgbGV0IGRvbmUgPSB0cnVlOwogICAgICB0aGlzLmNvcmVMaXN0W3RoaXMuaW5kZXhdLmRhdGEgPSB0cnVlOwogICAgICBsZXQgbmV4dEluZGV4ID0gLTE7CgkJICBmb3IobGV0IGkgaW4gdGhpcy5jb3JlTGlzdCl7CgkJCSAgaWYoICF0aGlzLmNvcmVMaXN0W2ldLmRhdGEgKXsKCQkJCSAgZG9uZSA9IGZhbHNlOwoJCQkJICBuZXh0SW5kZXggPSBpOwoJCQkJICBicmVhazsKCQkJICB9CgkJICB9CgoJCSAgaWYoIGRvbmUgKXsKCQkJbGV0IG1lc3NhZ2VzID0gW3ttZXNzYWdlOiAiRE9ORSJ9XTsKCQkJCgkJCWNhbGxiYWNrKG1lc3NhZ2VzKTsKCQkgfQoJCSBlbHNlIHsKCQkgCWdldENvcmVMb2coY29uZmlnLGNvcmVMaXN0LGRldGFpbHMsY2FsbGJhY2ssbmV4dEluZGV4KTsKCQkgfQogICAgfS5iaW5kKHtjbGllbnQ6IGNsaWVudCxjb3JlTGlzdDogY29yZUxpc3QsaW5kZXg6IGluZGV4LG91dFN0cmVhbTogb3V0U3RyZWFtfSk7CiAKIAlsZXQgY2IyID0gZnVuY3Rpb24oKXsKCSAgICAvL2NvbnNvbGUuZXJyb3IoIkVSUk9SIixlcnIubWVzc2FnZSk7CgkgICAgdGhpcy5jYigpOwoJICB9LmJpbmQoe2NiOiBjYn0pOwogICAgIGNvbnNvbGUubG9nKCJjb25uZWN0IixyZW1vdGVQYXRoLG9wdGlvbnMpOwogICAgY2xpZW50LmdldChyZW1vdGVQYXRoLCBvdXRTdHJlYW0sb3B0aW9ucykudGhlbihjYikKCSAgLmNhdGNoKGNiMik7CgogICAgY2hlY2tTaXplKGNsaWVudCxjYik7CgoKCQkgIAogIH0KCiAgZnVuY3Rpb24gc2hhbGxvd0Nsb25lKGFyZ3MpewogIAlsZXQgcmVzdWx0ID0ge307CgogIAlpZiggYXJncyl7CgkgIAlmb3IobGV0IHAgaW4gYXJncyl7CgkgIAkJaWYoIGFyZ3MuaGFzT3duUHJvcGVydHkocCkgKSAKCSAgCQkJcmVzdWx0W3BdID0gYXJnc1twXTsKCSAgCX0KCX0KCiAgCS8vYWNvbnNvbGUubG9nKCJjbG9uZSIsYXJncyxyZXN1bHQpOwogIAlyZXR1cm4oIHJlc3VsdCApOwogIH0KCmZ1bmN0aW9uIGdldENvcmVMb2coY29uZmlnLGNvcmVMaXN0LGRldGFpbHMsY2FsbGJhY2ssc3RhcnRJbmRleCl7CgkKCWxldCBnZXRMb2dGaWxlID0gZnVuY3Rpb24oaSl7CgkJbGV0IHN0YXJ0VG9rZW4gPSAiaHR0cDovLyI7CgkJbGV0IGVuZFRva2VuID0gIi9zb2xyIjsKCQlsZXQgY29yZUxpc3QgPSB0aGlzLmNvcmVMaXN0OwoJCWxldCBjb25maWcgPSB0aGlzLmNvbmZpZzsKCQlsZXQgZGV0YWlscyA9IHRoaXMuZGV0YWlsczsKCQlsZXQgY2FsbGJhY2sgPSB0aGlzLmNhbGxiYWNrOwoKCQkvL2xldCBtZXNzYWdlcyA9IFtdOwoJCWlmKCBpIDwgY29yZUxpc3QubGVuZ3RoICl7CgkJCWxldCB0Q29yZSA9IGNvcmVMaXN0W2ldLnVybDsKCSAgICAgICAgbGV0IHRQYXRoID0gY29yZUxpc3RbaV0ucGF0aDsKCgkJCWxldCBpZHggPSB0Q29yZS5pbmRleE9mKHN0YXJ0VG9rZW4pOwoJCQlsZXQgc2lkeCA9IHRDb3JlLmluZGV4T2YoZW5kVG9rZW4pOwoJCQlpZiggaWR4ID4gLTEgJiYgc2lkeCA+IC0xICl7CgkJCQlsZXQgc291cmNlU29sckhvc3QgPSB0Q29yZS5zdWJzdHJpbmcoaWR4ICsgc3RhcnRUb2tlbi5sZW5ndGgsc2lkeCk7CgkJCQlsZXQgc291cmNlU29sclBvcnQgPSA4MDsKCQkJCWxldCBwaWR4ID0gc291cmNlU29sckhvc3QuaW5kZXhPZigiOiIpOwoJCQkJaWYoIHBpZHggPiAtMSApewoJCQkJCXNvdXJjZVNvbHJQb3J0ID0gc291cmNlU29sckhvc3Quc3Vic3RyaW5nKHBpZHgrMSk7CgkJCQkJc291cmNlU29sckhvc3QgPSBzb3VyY2VTb2xySG9zdC5zdWJzdHJpbmcoMCxwaWR4KTsKCQkJCX0KCQkJCWxldCB0Q29uZmlnID0gc2hhbGxvd0Nsb25lKGNvbmZpZyk7CgkJICAgICAgICB0Q29uZmlnLmhvc3QgPSBzb3VyY2VTb2xySG9zdDsKCQkgICAgICAgICAgIAoKCSAgICAgICAgICAgIC8vbGV0IHQgPSBodHRwLmdldCh7aG9zdDogc291cmNlU29sckhvc3QscG9ydDogc291cmNlU29sclBvcnQscGF0aDogdFBhdGh9LCB0Q2FsbGJhY2spOwoJICAgICAgICAgICAgbGV0IHNjYiA9IGZ1bmN0aW9uKCl7CgkgICAgICAgICAgICAJbGV0IHNmdENsaWVudCA9IG5ldyBTU0gyQ2xpZW50KCk7CgkJICAgICAgICAgICAgbGV0IHRDYWxsYmFjayA9IGdldENvcmVMb2dDYWxsYmFjay5iaW5kKHtzb3VyY2VTb2xySG9zdDogdGhpcy5zb3VyY2VTb2xySG9zdCxjbGllbnQ6IHNmdENsaWVudCxvdXRTdHJlYW06IHRoaXMub3V0U3RyZWFtLG91dEZpbGVOYW1lOnRoaXMub3V0RmlsZU5hbWUsZGV0YWlsczogdGhpcy5kZXRhaWxzLGluZGV4OiB0aGlzLmluZGV4LGNvcmVMaXN0OiB0aGlzLmNvcmVMaXN0LGNhbGxiYWNrOiB0aGlzLmNhbGxiYWNrfSk7CgkJICAgICAgICAgICAgCgkJICAgICAgICAgICAgc2Z0Q2xpZW50LmNvbm5lY3QodGhpcy5jb25maWcpLnRoZW4odENhbGxiYWNrKTsKCSAgICAgICAgICAgIH0uYmluZCh7c291cmNlU29sckhvc3Q6IHNvdXJjZVNvbHJIb3N0LG91dFN0cmVhbTogZGV0YWlscy5vdXRTdHJlYW0sb3V0RmlsZU5hbWU6ZGV0YWlscy5vdXRGaWxlTmFtZSxkZXRhaWxzOiBkZXRhaWxzLGluZGV4OiBpLGNvcmVMaXN0OiBjb3JlTGlzdCxjYWxsYmFjazogY2FsbGJhY2ssY29uZmlnOiB0Q29uZmlnfSk7CgkgICAgICAgICAgICAKCSAgICAgICAgICAgIGNvcHlGaWxlRmlyc3QodENvbmZpZyxzY2IpOwoJICAgICAgICB9CgkJfQoJfS5iaW5kKHtjb3JlTGlzdDogY29yZUxpc3QsY29uZmlnOiBjb25maWcsZGV0YWlsczogZGV0YWlscyxjYWxsYmFjazogY2FsbGJhY2t9KTsKCgoJaWYoIGNvcmVMaXN0Lmxlbmd0aCA9PSAwICkKCQljYWxsYmFjayhbe21lc3NhZ2U6ICJOT0NPUkUifV0pOwoJZWxzZQoJCWdldExvZ0ZpbGUoc3RhcnRJbmRleCk7Cn0KCgpmdW5jdGlvbiBnZXRMb2dzQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBzb3VyY2VTb2xySG9zdCA9IHRoaXMuc291cmNlU29sckhvc3Q7CiAgbGV0IHNvdXJjZVNvbHJQb3J0ID0gdGhpcy5zb3VyY2VTb2xyUG9ydDsKICBsZXQgc291cmNlU29sckNvbGxlY3Rpb24gPSB0aGlzLnNvdXJjZVNvbHJDb2xsZWN0aW9uOwogIGxldCBvdXRGaWxlTmFtZSA9IHRoaXMub3V0RmlsZU5hbWU7CiAgbGV0IG91dFN0cmVhbSA9IHRoaXMub3V0U3RyZWFtOwogIGxldCBjYWxsYmFjayA9IHRoaXMuY2FsbGJhY2s7CiAgCiAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwogICAgICAgICAgICAgIAogICAgICAgIH0pOwoKICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zb2xlLmxvZygiQ0xVU1RFUlNUQVRVUyIsc291cmNlU29sckhvc3Qsc291cmNlU29sclBvcnQsc291cmNlU29sckNvbGxlY3Rpb24pOwoJCWxldCBjbHVzdGVyU3RhdHVzID0gSlNPTi5wYXJzZShzdHIpOwoJCQoJCWlmKCBjbHVzdGVyU3RhdHVzLmNsdXN0ZXIgICYmIGNsdXN0ZXJTdGF0dXMuY2x1c3Rlci5jb2xsZWN0aW9ucyAmJiBjbHVzdGVyU3RhdHVzLmNsdXN0ZXIuY29sbGVjdGlvbnNbc291cmNlU29sckNvbGxlY3Rpb25dICl7CgkJCWxldCBjb2xsZWN0aW9uSW5mbyA9IGNsdXN0ZXJTdGF0dXMuY2x1c3Rlci5jb2xsZWN0aW9uc1tzb3VyY2VTb2xyQ29sbGVjdGlvbl07CgoJCQlpZiggY29sbGVjdGlvbkluZm8uc2hhcmRzICl7CgkJCQlsZXQgY29yZUxpc3QgPSBbXTsKCQkJCWZvcihsZXQgcyBpbiBjb2xsZWN0aW9uSW5mby5zaGFyZHMpewoJCQkJCWxldCBzaGFyZCA9IGNvbGxlY3Rpb25JbmZvLnNoYXJkc1tzXTsKCQkJCQlmb3IobGV0IHIgaW4gc2hhcmQucmVwbGljYXMpewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVwbGljYSA9IHNoYXJkLnJlcGxpY2FzW3JdOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygicmVwbGljYSIscmVkYWN0KHJlcGxpY2EsInBhc3N3b3JkIikpOwoJCQkJCQlpZiggcmVwbGljYS5zdGF0ZSA9PSAnYWN0aXZlJyApewoJCQkJCQkJY29yZUxpc3QucHVzaCh7dXJsOiByZXBsaWNhLmJhc2VfdXJsLHBhdGg6Ii9zb2xyL2FkbWluL2luZm8vbG9nZ2luZz9fPTE1NzQyMDA0MzE2NzEmc2luY2U9MCZ3dD1qc29uIn0pOwoJCQkJCQkJLy9icmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCWdldENvcmVMb2coY29uZmlnLGNvcmVMaXN0LHtvdXRGaWxlTmFtZTogb3V0RmlsZU5hbWUsb3V0U3RyZWFtOiBvdXRTdHJlYW19LGNhbGxiYWNrLDApOwoJCQl9CgkJCWVsc2UgewoJCQkJY2FsbGJhY2soe2NvbGxlY3Rpb246IHNvdXJjZVNvbHJDb2xsZWN0aW9uLG1lc3NhZ2VzOiBbe21lc3NhZ2U6ICJOTyBTSEFSRFMifV19KTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJY29uc29sZS5sb2coIk5PIERFU1RJTkFUSU9OIixzb3VyY2VTb2xyQ29sbGVjdGlvbik7CgkJCWNhbGxiYWNrKHtjb2xsZWN0aW9uOiBzb3VyY2VTb2xyQ29sbGVjdGlvbixtZXNzYWdlczogW3ttZXNzYWdlOiAiTk8gREVTVElOQVRJT04ifV19KTsKCQl9CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldENvcmVTdGF0cyhhcmdzLGNhbGxiYWNrKXsKCWxldCBzb3VyY2VTb2xySG9zdCA9IGFyZ3MuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJIb3N0JykgPyBhcmdzWydzb3VyY2VTb2xySG9zdCddIDogImMzLnNvbHJjbG91ZC5zZXJ2aWNlLmludHJhYm8xLmNvbnN1bC5jc256b28uY29tIjsKCWxldCBzb3VyY2VTb2xyUG9ydCA9IGFyZ3MuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJQb3J0JykgPyBhcmdzWydzb3VyY2VTb2xyUG9ydCddIDogODE4MDsKCWxldCBzb3VyY2VTb2xyQ29sbGVjdGlvbiA9IGFyZ3MuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJDb2xsZWN0aW9uJykgPyBhcmdzWydzb3VyY2VTb2xyQ29sbGVjdGlvbiddIDogJ2Rlbm9ybV91cyc7CiAgICBsZXQgb3V0RmlsZU5hbWUgPSBhcmdzLmhhc093blByb3BlcnR5KCdvdXRGaWxlTmFtZScpID8gYXJnc1snb3V0RmlsZU5hbWUnXSA6ICcvd2F5ZmFpci9kYXRhL2Rlbm9ybV9zb2xyLmxvZyc7CiAgICB2YXIgb3V0U3RyZWFtID0gZnMuY3JlYXRlV3JpdGVTdHJlYW0ob3V0RmlsZU5hbWUpOwogICAgICAgIGNvbW1hbmRMaW5lLm91dEZpbGVOYW1lID0gb3V0RmlsZU5hbWU7CglvdXRTdHJlYW0ud3JpdGFibGUgPSB0cnVlOwogICAgbGV0IG1heFNpemUgPSBhcmdzLmhhc093blByb3BlcnR5KCdtYXhTaXplJykgPyBhcmdzWydtYXhTaXplJ10gOiAxMCoxMDAwMDAwOwogICAgICAgY29tbWFuZExpbmUubWF4U2l6ZSA9IG1heFNpemU7CglsZXQgdENhbGxiYWNrID0gZ2V0TG9nc0NhbGxiYWNrLmJpbmQoe3NvdXJjZVNvbHJIb3N0OiBzb3VyY2VTb2xySG9zdCxzb3VyY2VTb2xyUG9ydDogc291cmNlU29sclBvcnQsc291cmNlU29sckNvbGxlY3Rpb246IHNvdXJjZVNvbHJDb2xsZWN0aW9uLG91dEZpbGVOYW1lOiBvdXRGaWxlTmFtZSxvdXRTdHJlYW06IG91dFN0cmVhbSxjYWxsYmFjazogY2FsbGJhY2t9KTsKCWxldCB0ID0gaHR0cC5nZXQoe2hvc3Q6IHNvdXJjZVNvbHJIb3N0LHBvcnQ6IHNvdXJjZVNvbHJQb3J0LHBhdGg6ICIvc29sci9hZG1pbi9jb2xsZWN0aW9ucz9hY3Rpb249Q0xVU1RFUlNUQVRVUyZ3dD1qc29uIn0sIHRDYWxsYmFjayx0Q2FsbGJhY2spOwp9CgpmdW5jdGlvbiBjYihtZXNzYWdlcyl7Cgljb25zb2xlLmxvZygiY29tcGxldGUiLG1lc3NhZ2VzKTsKfQpnZXRDb3JlU3RhdHMoY29tbWFuZExpbmUsY2IpOwoKCn0=","testharvestscript_s":"username=search password= maxSize=10000000 sourceSolrHost=server1 sourceSolrCollection=collection1 outFileName=/tmp/out_solr.log","testcopyscript_s":"testName=siemens sourceSolrIdField=id sourceSolrHostA=server1 sourceSolrCollectionA=collection1 destinationSolrHostA=server2 destinationSolrCollectionA=collection2 sourceSolrHostB=server1 sourceSolrCollectionB=collection1 destinationSolrHostB=server2 destinationSolrCollectionB=collection2","testbuildscript":"ZnVuY3Rpb24oY29tbWFuZExpbmUpewp2YXIgc29sckhvc3QgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc29sckhvc3QnKSA/IGNvbW1hbmRMaW5lWydzb2xySG9zdCddIDogQ09OVEVYVC5TT0xSSE9TVDsKdmFyIHNvbHJQb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvbHJQb3J0JykgPyBjb21tYW5kTGluZVsnc29sclBvcnQnXSA6IENPTlRFWFQuU09MUlBPUlQ7CnZhciBzb2xyQ29sbGVjdGlvbiA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdzb2xyQ29sbGVjdGlvbicpID8gY29tbWFuZExpbmVbJ3NvbHJDb2xsZWN0aW9uJ10gOiBDT05URVhULlNPTFJDT0xMRUNUSU9OOwp2YXIgc29sclBhdGggPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc29sclBhdGgnKSA/IGNvbW1hbmRMaW5lWydzb2xyUGF0aCddIDogIi9zb2xyLyIgKyBzb2xyQ29sbGVjdGlvbiArICIvdXBkYXRlIjsKdmFyIGJhdGNoU2l6ZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdiYXRjaFNpemUnKSA/IGNvbW1hbmRMaW5lWydiYXRjaFNpemUnXSA6IDEwOwp2YXIgaW5GaWxlTmFtZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdpbkZpbGVOYW1lJykgPyBjb21tYW5kTGluZVsnaW5GaWxlTmFtZSddIDogJy90bXAvb3V0X3NvbHIubG9nJzsKdmFyIHRlc3ROYW1lID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3Rlc3ROYW1lJykgPyBjb21tYW5kTGluZVsndGVzdE5hbWUnXSA6ICdjb3Zlb2Jhc2UnOwp2YXIgc3RhcnRUYWcgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc3RhcnRUYWcnKSA/IGNvbW1hbmRMaW5lWydzdGFydFRhZyddIDogJ3BhcmFtcz17JzsKdmFyIGVuZFRhZyA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdlbmRUYWcnKSA/IGNvbW1hbmRMaW5lWydlbmRUYWcnXSA6ICd9IGhpdHM9JzsKdmFyIGtleVRhZyA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdrZXlUYWcnKSA/IGNvbW1hbmRMaW5lWydrZXlUYWcnXSA6ICcnOwp2YXIgcmVxdWlyZWRUYWcgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgncmVxdWlyZWRUYWcnKSA/IGNvbW1hbmRMaW5lWydyZXF1aXJlZFRhZyddIDogImM6IiArIHRlc3ROYW1lOwp2YXIgaWRTZWVkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2lkU2VlZCcpID8gY29tbWFuZExpbmVbJ2lkU2VlZCddIDogJ1NFQVJDSCc7CnZhciBpZ25vcmVQYXR0ZXJuID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2lnbm9yZVBhdHRlcm4nKSA/IGNvbW1hbmRMaW5lWydpZ25vcmVQYXR0ZXJuJ10uc3BsaXQoIiwiKSA6IFsncT0qOiomcm93cz0wJnd0PWpzb24nLCdudW1UZXJtcz0wJnNob3c9aW5kZXgmd3Q9anNvbiddOwp2YXIgZG9Xb3JrID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2RvV29yaycpID8gY29tbWFuZExpbmVbJ2RvV29yayddID09PSAndHJ1ZScgOiB0cnVlOwpsZXQgcGFzc1Rocm91Z2hQYXJhbXMgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgncGFzc1Rocm91Z2hQYXJhbXMnKSA/IGNvbW1hbmRMaW5lWydwYXNzVGhyb3VnaFBhcmFtcyddLnNwbGl0KCIsIikgOiBbIioiXTsKdmFyIHVzZUFzU2VlZCAgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndXNlQXNTZWVkJykgPyBjb21tYW5kTGluZVsndXNlQXNTZWVkJ10gPT09ICd0cnVlJyA6IHRydWU7CnZhciBzZWVkVGVtcGxhdGUgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc2VlZFRlbXBsYXRlJykgPyBjb21tYW5kTGluZVsnc2VlZFRlbXBsYXRlJ10gOiAnJzsKdmFyIGNzdkRhdGEgID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2NzdkRhdGEnKSA/IGNvbW1hbmRMaW5lWydjc3ZEYXRhJ10ucmVwbGFjZSgvXCsvZywnICcpIDogZmFsc2U7CgpmdW5jdGlvbiBjYWxsYmFjayhyZXMpIHsKCiAgICB2YXIgc3RyID0gIiI7CgogICAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgCiAgICAgICAgfSk7CgogICAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZmllbGQpOwogICAgICAgIGNvbnNvbGUubG9nKHN0cik7CiAgICB9KTsKfQoKCmZ1bmN0aW9uIGV4dHJhY3RQYXJhbXMoc3RyKXsKICAgbGV0IHJlc3VsdCA9IFtdOwoKICAgaWYoIHN0ciApewogICAgICB0cnkgewogICAgICAgICAgdmFyIHVQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHN0cik7CiAgICAgICAgICB1UGFyYW1zLmZvckVhY2goZnVuY3Rpb24odmFsdWUsa2V5KXsgcmVzdWx0LnB1c2goe25hbWU6IGtleSx2YWx1ZTogdmFsdWV9KTt9KTsKCiAgICAgIH0KICAgICAgY2F0Y2goZSl7CiAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCBwYXJzaW5nOiAiICsgZSk7CiAgICAgIH0KCiAgIH0KCiAgIHJldHVybiggcmVzdWx0ICk7Cn0KCmZ1bmN0aW9uIGNoZWNrUGFyYW0ocCl7CglsZXQgcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgbGV0IHRwID0gcCArICIiOwoKICAgICAgICBmb3IobGV0IGkgaW4gcGFzc1Rocm91Z2hQYXJhbXMpewoJCWlmKCBwYXNzVGhyb3VnaFBhcmFtc1tpXSA9PSAiKiIgfHwgKHBhc3NUaHJvdWdoUGFyYW1zW2ldLmVuZHNXaXRoKCIqIikgJiYgdHAuc3RhcnRzV2l0aChwYXNzVGhyb3VnaFBhcmFtc1tpXS5zdWJzdHJpbmcoMCxwYXNzVGhyb3VnaFBhcmFtc1tpXS5sZW5ndGgtMSkpICkgfHwgdHAuaW5kZXhPZihwYXNzVGhyb3VnaFBhcmFtc1tpXSkgPiAtMSApewoJCQlyZXN1bHQgPSB0cnVlOwoJCQlicmVhazsKCQl9Cgl9IAoJcmV0dXJuKCByZXN1bHQgKTsKfQoKZnVuY3Rpb24gY2hlY2tJZ25vcmVQYXR0ZXJuKHApewoJbGV0IHJlc3VsdCA9IGZhbHNlOwoKICAgICAgICBmb3IobGV0IGkgaW4gaWdub3JlUGF0dGVybil7CgkJaWYoIHAuaW5kZXhPZihpZ25vcmVQYXR0ZXJuW2ldKSA+IC0xICl7CgkJCXJlc3VsdCA9IHRydWU7CgkJCWJyZWFrOwoJCX0KCX0gCglyZXR1cm4oIHJlc3VsdCApOwp9CgpmdW5jdGlvbiBnZXRSZXF1aXJlZFBhcmFtcyhsaW5lKXsKICAgbGV0IHJlc3VsdCA9ICcnOwogICBsZXQgcGFyYW1zID0gZXh0cmFjdFBhcmFtcyhsaW5lKTsKCiAgIGZvcihsZXQgaSBpbiBwYXJhbXMpewogICAgIGxldCBwID0gcGFyYW1zW2ldLm5hbWU7CgogICAgIGlmKCAgY2hlY2tQYXJhbShbcF0pICl7CgogICAgICAgIGlmKCByZXN1bHQubGVuZ3RoID4gMCApIHJlc3VsdCArPSAiJiI7CiAgICAgICAgcmVzdWx0ICs9IHAgKyAiPSIgKyBwYXJhbXNbaV0udmFsdWU7CiAgICAgfQogICB9CiAgIGNvbnNvbGUubG9nKCJwYXJhbXMiLHJlc3VsdCk7CgogICByZXR1cm4oIHJlc3VsdCApOwp9CgpmdW5jdGlvbiBmbGF0dGVuRnJhbWUocmVjKXsKCWxldCByZXN1bHQgPSAnJzsKCglpZiggcmVjICkgewoJCWZvcihsZXQgcCBpbiByZWMpewoJCSAgICAgaWYoIHJlc3VsdC5sZW5ndGggPiAwICkgcmVzdWx0ICs9ICImIjsKCQkgICAgIHJlc3VsdCArPSBwICsgJz0nICsgcmVjW3BdOwoJCX0KCX0KY29uc29sZS5sb2coImZsYXR0ZW4iLHJlc3VsdCk7CglyZXR1cm4oIHJlc3VsdCApOwp9Cgp2YXIgcmwgPSBmYWxzZTsKCmlmKCBjc3ZEYXRhICl7CiAgICB2YXIgaW5zdHJlYW0gPSBuZXcgQ09OVEVYVC5saWIuc3RyZWFtLlBhc3NUaHJvdWdoKCkKICAgIGluc3RyZWFtLndyaXRlKGNzdkRhdGEpOwogICAgaW5zdHJlYW0uZW5kKCk7CiAgICBybCA9IHJlYWRsaW5lLmNyZWF0ZUludGVyZmFjZSh7CiAgICAgICAgaW5wdXQ6IGluc3RyZWFtLAogICAgICAgIHRlcm1pbmFsOiBmYWxzZQogICAgICAgIH0pOwp9CmVsc2UgewogICAgdmFyIGluc3RyZWFtID0gQ09OVEVYVC5saWIuZnMuY3JlYXRlUmVhZFN0cmVhbShpbkZpbGVOYW1lKTsKICAgIGluc3RyZWFtLnJlYWRhYmxlID0gdHJ1ZTsKCiAgICBybCA9IENPTlRFWFQubGliLnJlYWRsaW5lLmNyZWF0ZUludGVyZmFjZSh7CiAgICBpbnB1dDogaW5zdHJlYW0sCiAgICB0ZXJtaW5hbDogZmFsc2UKICAgIH0pOwp9Cgp2YXIgcm93Q291bnRlciA9IDA7CnZhciByb3dMaXN0ID0gW107CgpmdW5jdGlvbiByZWFkRnVuYyhsaW5lKSB7CiAgICAvL29uc29sZS5sb2cobGluZSk7CiAgICBpZiggdXNlQXNTZWVkICl7CiAgICAgICAgbGV0IHRSZWMgPSB7aWQ6IGlkU2VlZCArIHRlc3ROYW1lICsgcm93Q291bnRlciwiY29udGVudHR5cGUiOiAnU0VBUkNIJywidGVzdG5hbWUiOiB0ZXN0TmFtZX07CiAgICAgICAgdFJlY1sicXVlcnlfdHh0Il0gPSBzZWVkVGVtcGxhdGUgKyBsaW5lOwogICAgICAgIC8vY29uc29sZS5sb2coImRhdGEiLHRSZWMpOwogICAgICAgIHJvd0xpc3QucHVzaCh0UmVjKTsKICAgICAgICAKICAgICAgICBpZiggcm93TGlzdC5sZW5ndGggPiBiYXRjaFNpemUgKXsKICAgICAgICAgICAgc2VuZFRvU29scihjYWxsYmFjayk7CiAgICAgICAgfQogICAgICAgIHJvd0NvdW50ZXIrKzsKICAgIH0KICAgIGVsc2UgewogICAgICBsZXQgaWR4ID0gLTE7CiAgICAgIGlmKCBsaW5lLmluZGV4T2YoImh0dHA6IikgPCAwICYmICggIXJlcXVpcmVkVGFnIHx8IGxpbmUuaW5kZXhPZihyZXF1aXJlZFRhZykgPiAtMSApICYmIChpZHggPSBsaW5lLmluZGV4T2Yoc3RhcnRUYWcpKSA+IC0xICl7CiAgICAgICAgICBsaW5lID0gbGluZS5zdWJzdHJpbmcoaWR4K3N0YXJ0VGFnLmxlbmd0aCk7CiAgICAgICAgICBpZiggIGtleVRhZyAmJiAoaWR4ID0gbGluZS5pbmRleE9mKGtleVRhZykpID4gLTEgKXsKICAgICAgICAgICAgICBsaW5lID0gbGluZS5zdWJzdHJpbmcoaWR4K2tleVRhZy5sZW5ndGgpLnRyaW0oKTsKICAgICAgICAgIH0KICAgICAgICAgIAogICAgICAgICAgaWYoIChpZHggPSBsaW5lLmluZGV4T2YoZW5kVGFnKSkgPiAtMSApewogICAgICAgICAgICAgIGxpbmUgPSBsaW5lLnN1YnN0cmluZygwLGlkeCkudHJpbSgpOwogICAgICAgICAgICAgIGlmKCAhY2hlY2tJZ25vcmVQYXR0ZXJuKGxpbmUpICl7CiAgICAgICAgICAgICAgLy9pZiggbGluZS5pbmRleE9mKCJ3dD1qYXZhYmluIikgPiAtMSApICBsaW5lID0gbGluZS5yZXBsYWNlKCJ3dD1qYXZhYmluIiwid3Q9anNvbiIpOwogICAgICAgICAgICAgIC8vaWYoIGxpbmUuaW5kZXhPZigic2hhcmQudXJsPSIpID4gLTEgKSAgbGluZSA9IGxpbmUucmVwbGFjZSgic2hhcmQudXJsPSIsInRzaGFyZC51cmw9Iik7CiAgICAgICAgICAgICAgLy9pZiggbGluZS5pbmRleE9mKCJkaXN0cmliPWZhbHNlIikgPiAtMSApICBsaW5lID0gbGluZS5yZXBsYWNlKCJkaXN0cmliPWZhbHNlIiwiZGlzdHJpYj10cnVlIik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2cobGluZSk7CiAgICAgICAgICAKICAgICAgICAgICAgICBsZXQgdFJlYyA9IHtpZDogaWRTZWVkICsgdGVzdE5hbWUgKyByb3dDb3VudGVyLCJjb250ZW50dHlwZSI6ICdTRUFSQ0gnLCJ0ZXN0bmFtZSI6IHRlc3ROYW1lfTsKICAgICAgICAgICAgICAvL3RSZWNbInF1ZXJ5X3R4dCJdID0gbGluZTsKICAJICAgIHRSZWNbInF1ZXJ5X3R4dCJdID0gZ2V0UmVxdWlyZWRQYXJhbXMobGluZSk7CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiZGF0YSIsdFJlYyk7CiAgICAgICAgICAgICAgcm93TGlzdC5wdXNoKHRSZWMpOwogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmKCByb3dMaXN0Lmxlbmd0aCA+IGJhdGNoU2l6ZSApewogICAgICAgICAgICAgICAgICBzZW5kVG9Tb2xyKGNhbGxiYWNrKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcm93Q291bnRlcisrOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgfQogICAgICBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygiaW52YWxpZCBsaW5lIiwgKCAhcmVxdWlyZWRUYWcgfHwgbGluZS5pbmRleE9mKHJlcXVpcmVkVGFnKSA+IC0xICkgJiYgbGluZS5pbmRleE9mKHN0YXJ0VGFnKSA+IC0xPyBsaW5lIDogIklWIixzdGFydFRhZyApOwogICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIHNlbmRUb1NvbHIoY2FsbGJhY2spewogICAgY29uc29sZS53c2xvZyhyb3dMaXN0KTsKICAgIGlmKCBkb1dvcmsgKXsKICAgIGxldCB0Q2FsbGJhY2sgPSBjYWxsYmFjay5iaW5kKHt9KTsKICAgIGxldCBjb25mID0ge2hvc3RuYW1lOiBzb2xySG9zdCxwb3J0OiBzb2xyUG9ydCxwYXRoOiBzb2xyUGF0aCxtZXRob2Q6ICdQT1NUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319OwogICAgaWYoIENPTlRFWFQuQVVUSEtFWSApewogICAgICAgICBjb25mLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCYXNpYyAnICsgQ09OVEVYVC5BVVRIS0VZOwogICAgfQogICAgbGV0IHQgPSBDT05URVhULmxpYi5odHRwLnJlcXVlc3QoY29uZiwgdENhbGxiYWNrKTsKICAgIHQub24oJ2Vycm9yJywgZnVuY3Rpb24oZSkge2NvbnNvbGUubG9nKCJHb3QgZXJyb3I6ICIgKyBlLm1lc3NhZ2UpO30pOwogICAgdC53cml0ZShKU09OLnN0cmluZ2lmeShyb3dMaXN0KSk7CiAgICB0LmVuZCgpOwogICAgfQogICAgcm93TGlzdCA9IFtdOwp9CgpmdW5jdGlvbiBkb0NvbW1pdCgpewogICAgaWYoIGRvV29yayApewogICAgICAgIGxldCBkb0ZpbmFsbHkgPSBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgdENhbGxiYWNrID0gY2FsbGJhY2suYmluZCh7fSk7CiAgICAgICAgICAgIGxldCBjb25mID0ge2hvc3RuYW1lOiBzb2xySG9zdCxwb3J0OiBzb2xyUG9ydCxwYXRoOiBzb2xyUGF0aCxtZXRob2Q6ICdQT1NUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319OwogICAgICAgICAgICBpZiggQ09OVEVYVC5BVVRIS0VZICl7CiAgICAgICAgICAgICAgICBjb25mLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCYXNpYyAnICsgQ09OVEVYVC5BVVRIS0VZOwogICAgICAgICAgICAgfQogICAgICAgICAgICBjb25mLnBhdGggPSBzb2xyUGF0aCArICI/Y29tbWl0PXRydWUiOwogICAgICAgICAgICB2YXIgdCA9IENPTlRFWFQubGliLmh0dHAuZ2V0KGNvbmYsIHRDYWxsYmFjayk7CgogICAgICAgICAgICBpZiggY29tbWFuZExpbmUuY2FsbGJhY2sgKSBjb21tYW5kTGluZS5jYWxsYmFjayhjb21tYW5kTGluZS5yZXN1bHRDb250ZXh0KTsKICAgICAgICB9CgogICAgICAgIGlmKCByb3dMaXN0ICYmIHJvd0xpc3QubGVuZ3RoID4gMCApCiAgICAgICAgICAgIHNlbmRUb1NvbHIoZG9GaW5hbGx5KTsKICAgICAgICBlbHNlICAgIAogICAgICAgICAgICBkb0ZpbmFsbHkoKTsKICAgIH0KfQppZiggcmwgKSBybC5vbignbGluZScsIHJlYWRGdW5jKTsKaWYoIHJsICkgcmwub24oJ2Nsb3NlJywgZG9Db21taXQpOwp9","testbuildscript_s":"inFileName=/tmp/out_solr.log testName=siemens useAsSeed=true csvData= requiredTag=collection1","testextractscript":"ZnVuY3Rpb24ob0NvbW1hbmRMaW5lKXsKCQlmdW5jdGlvbiBleHRyYWN0VGVzdChjb21tYW5kTGluZSl7CgkJdmFyIGJhdGNoU2l6ZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdiYXRjaFNpemUnKSA/IGNvbW1hbmRMaW5lWydiYXRjaFNpemUnXSA6IDEwOwoJCXZhciBzb3VyY2VSZXN1bHRTaXplID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVJlc3VsdFNpemUnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VSZXN1bHRTaXplJ10gOiAxMDsKCQl2YXIgdGVzdE5hbWUgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndGVzdE5hbWUnKSA/IGNvbW1hbmRMaW5lWyd0ZXN0TmFtZSddIDogJyc7CiAgICAgICAgdmFyIHNvdXJjZU1vZGUgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlTW9kZScpID8gY29tbWFuZExpbmVbJ3NvdXJjZU1vZGUnXSA6ICdTT0xSJzsKCgkJdmFyIHNvdXJjZVNvbHJIb3N0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJIb3N0JykgPyBjb21tYW5kTGluZVsnc291cmNlU29sckhvc3QnXSA6IENPTlRFWFQuU09MUkhPU1Q7CgkJdmFyIHNvdXJjZVNvbHJQb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJQb3J0JykgPyBjb21tYW5kTGluZVsnc291cmNlU29sclBvcnQnXSA6IENPTlRFWFQuU09MUlBPUlQ7CgkJdmFyIHNvdXJjZVNvbHJDb2xsZWN0aW9uID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJDb2xsZWN0aW9uJykgPyBjb21tYW5kTGluZVsnc291cmNlU29sckNvbGxlY3Rpb24nXSA6IENPTlRFWFQuU09MUkNPTExFQ1RJT047CgkJdmFyIHNvdXJjZVNvbHJQYXRoID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJQYXRoJykgPyBjb21tYW5kTGluZVsnc291cmNlU29sclBhdGgnXSA6ICIvc29sci8iICsgc291cmNlU29sckNvbGxlY3Rpb24gKyAiL3NlbGVjdD9mbD0qJnd0PWpzb24mcm93cz0iICsgc291cmNlUmVzdWx0U2l6ZSArICImIjsKCQl2YXIgc291cmNlU29sckZpZWxkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJGaWVsZCcpID8gY29tbWFuZExpbmVbJ3NvdXJjZVNvbHJGaWVsZCddIDogImlkIjsKCQl2YXIgc291cmNlU29scklkRmllbGQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29scklkRmllbGQnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xySWRGaWVsZCddIDogImlkIjsKCgkJdmFyIHZhbGlkYXRlU29sckhvc3QgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xySG9zdCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sckhvc3QnXSA6IENPTlRFWFQuU09MUkhPU1Q7CgkJdmFyIHZhbGlkYXRlU29sclBvcnQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xyUG9ydCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sclBvcnQnXSA6IENPTlRFWFQuU09MUlBPUlQ7CgkJdmFyIHZhbGlkYXRlU29sclBhdGggPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xyUGF0aCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sclBhdGgnXSA6ICIvc29sci8iICsgQ09OVEVYVC5TT0xSQ09MTEVDVElPTiArICIvc2VsZWN0P2ZxPWNvbnRlbnR0eXBlOlNFQVJDSCZxPSh0ZXN0bmFtZToiICsgdGVzdE5hbWUgKyAiKSZ3dD1qc29uJnNvcnQ9aWQrZGVzYyZyb3dzPSIgKyBiYXRjaFNpemU7CgkJdmFyIHZhbGlkYXRlU29sclVwZGF0ZVBhdGggPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xyVXBkYXRlUGF0aCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sclVwZGF0ZVBhdGgnXSA6ICIvc29sci8iICsgQ09OVEVYVC5TT0xSQ09MTEVDVElPTiArICIvdXBkYXRlIjsKCQl2YXIgdmFsaWRhdGVTb2xyVHlwZUZpZWxkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sclR5cGVGaWVsZCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sclR5cGVGaWVsZCddIDogImNvbnRlbnR0eXBlIjsKCQl2YXIgdmFsaWRhdGVTb2xyVHlwZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJUeXBlJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyVHlwZSddIDogIkJFRk9SRSI7CgkJdmFyIHZhbGlkYXRlU29sckZpZWxkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sckZpZWxkJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyRmllbGQnXSA6ICJxdWVyeV90eHQiOwoJCXZhciB2YWxpZGF0ZVNvbHJJZEZpZWxkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29scklkRmllbGQnKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJJZEZpZWxkJ10gOiAiaWQiOwoJCXZhciBpbmNsdWRlRGV0YWlsID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2luY2x1ZGVEZXRhaWwnKSA/IGNvbW1hbmRMaW5lWydpbmNsdWRlRGV0YWlsJ10gOiAnJzsKCQl2YXIgd3JpdGVNb2RlID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3dyaXRlTW9kZScpID8gY29tbWFuZExpbmVbJ3dyaXRlTW9kZSddIDogJ3RydW5jYXRlJzsKCQl2YXIgY3Vyc29yTWFyayA9ICIqIjsKICAgICAgICB2YXIgcXVlcnlDb3VudCA9IDA7CiAgICAgICAgICAgICAgICAKCgkJZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhyZXMpIHsKCQkgIHZhciBzdHIgPSAiIjsKCQkgIAoJCSAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CgkJICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CgkJICAgICAgICAgICAgICAKCQkgICAgICAgIH0pOwoKCQkgIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJCQkJbGV0IGRhdGEgPSBKU09OLnBhcnNlKHN0cik7CgkJCQkKCQkJCWlmKCBkYXRhLnJlc3BvbnNlICYmIGRhdGEucmVzcG9uc2UuZG9jcyApewogICAgICAgICAgICAgICAgICAgIHF1ZXJ5Q291bnQgPSBkYXRhLnJlc3BvbnNlLmRvY3MubGVuZ3RoOwoJCQkJCWZvcihsZXQgZCBpbiBkYXRhLnJlc3BvbnNlLmRvY3MpewoJCQkJCQlsZXQgZG9jID0gZGF0YS5yZXNwb25zZS5kb2NzW2RdOwoJCQkJCQkKCQkJCQkJdmFsaWRhdGVRdWVyeShkb2MsZGF0YS5uZXh0Q3Vyc29yTWFyayAmJiBjdXJzb3JNYXJrICE9IGRhdGEubmV4dEN1cnNvck1hcmsgJiYgcXVlcnlDb3VudCA9PSBiYXRjaFNpemUpOwoJCQkJCX0KCQkJCX0KCQkJCS8vY29uc29sZS53c2xvZyhkYXRhKTsKCQkJCWlmKCBkYXRhLm5leHRDdXJzb3JNYXJrICl7CgkJCQkJaWYoIGN1cnNvck1hcmsgIT0gZGF0YS5uZXh0Q3Vyc29yTWFyayApewkKCQkJCQkJY3Vyc29yTWFyayA9IGRhdGEubmV4dEN1cnNvck1hcms7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQljb25zb2xlLndzbG9nKCJjb21wbGV0ZSIpOwoJCQkJCX0KCQkJCX0KCQkgIH0pOwoJCX0KCgkJZnVuY3Rpb24gdXBkYXRlQ2FsbGJhY2socmVzKSB7CgkJICB2YXIgc3RyID0gIiI7CgkJICByZXMucXVlcnlEb2MgPSB0aGlzLnF1ZXJ5RG9jOwoJCSAgdmFyIGhhc01vcmUgPSB0aGlzLmhhc01vcmU7CgoJCSAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CgkJICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CgkJICAgICAgICAgICAgICAKCQkgICAgICAgIH0pOwoKCQkgIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJCQkJY29uc29sZS53c2xvZyhyZXMucXVlcnlEb2MuaWQsIlVQREFURSIsc3RyKTsKCQkJCQoJCQkJY29uc29sZS53c2xvZygiY2hlY2tpbmcgcXVlcnkgY291bnQiLHF1ZXJ5Q291bnQpOwoJCQkJaWYoIHF1ZXJ5Q291bnQgPD0gMCApIHsKCQkJCQljb25zb2xlLndzbG9nKCJjYWxsIGxvYWQgc3liYyIsaGFzTW9yZSk7CgkJCQkJaWYoIGhhc01vcmUgKQoJCQkJCQlsb2FkVmFsaWRhdGlvbkRhdGEoY3Vyc29yTWFyayk7CgkJCQkJZWxzZQoJCQkJCQlkb0NvbW1pdCgpOwogICAgICAgICAgICAgICAgfQoJCSAgfSk7CgkJfQoKCQlmdW5jdGlvbiBjYWxsYmFjayhyZXMpIHsKCQkgIHZhciBzdHIgPSAiIjsKCQkgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewoJCSAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwoJCSAgICAgICAgICAgICAgCgkJICAgICAgICB9KTsKCgkJICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCQkgICAgICAgIGNvbnNvbGUud3Nsb2coIkNPTU1JVCIpOwoJCSAgfSk7CgkJfQoJCSAKCQlmdW5jdGlvbiBxdWVyeUNhbGxiYWNrKHJlcykgewoJCSAgdmFyIHN0ciA9ICIiOwoJCSAgcmVzLnF1ZXJ5RG9jID0gdGhpcy5xdWVyeURvYzsKCQkgIHZhciBoYXNNb3JlID0gdGhpcy5oYXNNb3JlOwoKCQkgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewoJCSAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwoJCSAgICAgICAgICAgICAgIAoJCSAgICAgICAgfSk7CgoJCSAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CgkJICAgICAgICAvL2NvbnNvbGUud3Nsb2cocmVzLmZpZWxkKTsKICAgICAgICAgICAgICAgIGxldCBkb2MgPSByZXMucXVlcnlEb2M7CiAgICAgICAgICAgICAgICBxdWVyeUNvdW50LS07CgogICAgICAgICAgICAgICAgCgoJCQkJLy9jb25zb2xlLndzbG9nKHJlcy5xdWVyeURvYyxzdHIpOwoJCQkJCgkJCQlsZXQgZGF0YSA9IEpTT04ucGFyc2Uoc3RyKTsKCQkJCWxldCBkb2NEZXRhaWxMaXN0ID0gW107CgkJCQkKICAgICAgICAgICAgICAgIGxldCBuZXdEb2MgPSB7ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdmFsaWRhdGVTb2xyVHlwZSArIGRvY1t2YWxpZGF0ZVNvbHJJZEZpZWxkXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRpZDogZG9jW3ZhbGlkYXRlU29scklkRmllbGRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5X3R4dDogZG9jW3ZhbGlkYXRlU29sckZpZWxkXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXN0bmFtZTogZG9jWyJ0ZXN0bmFtZSJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlaWQ6IGRvY1sibGFuZ3VhZ2VpZCJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWxpZDogZG9jWyJjaGFubmVsaWQiXSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHNvdXJjZVNvbHJIb3N0ICsgJy0nICsgc291cmNlU29sckNvbGxlY3Rpb24KCQkJCQkJCX07CgkJCQkJCQluZXdEb2NbdmFsaWRhdGVTb2xyVHlwZUZpZWxkXSA9IHZhbGlkYXRlU29sclR5cGU7CgogICAgICAgICAgICAgICAgbGV0IGRvY0xpc3QgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmKCBzb3VyY2VNb2RlID09ICdDT1ZFTycgKXsKICAgICAgICAgICAgICAgICAgICBuZXdEb2NbInJvd2NvdW50Il0gPSBkYXRhLnRvdGFsQ291bnQgPyBkYXRhLnRvdGFsQ291bnQgOiAwOwogICAgICAgICAgICAgICAgICAgIG5ld0RvY1sicXRpbWUiXSA9IGRhdGEuZHVyYXRpb24gPyBkYXRhLmR1cmF0aW9uIDogMDsKICAgICAgICAgICAgICAgICAgICBuZXdEb2NbInN0YXR1c19pIl0gPSBkYXRhLmR1cmF0aW9uID8gZGF0YS5kdXJhdGlvbiA6IDA7CiAgICAgICAgICAgICAgICAgICAgZG9jTGlzdCA9IGRhdGEucmVzdWx0czsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIG5ld0RvY1sicm93Y291bnQiXSA9IGRhdGEucmVzcG9uc2UgJiYgZGF0YS5yZXNwb25zZS5udW1Gb3VuZCA/IGRhdGEucmVzcG9uc2UubnVtRm91bmQgOiAwOwogICAgICAgICAgICAgICAgICAgIG5ld0RvY1sicXRpbWUiXSA9IGRhdGEucmVzcG9uc2VIZWFkZXIgJiYgZGF0YS5yZXNwb25zZUhlYWRlci5RVGltZSA/IGRhdGEucmVzcG9uc2VIZWFkZXIuUVRpbWUgOiAwOwogICAgICAgICAgICAgICAgICAgIG5ld0RvY1sic3RhdHVzX2kiXSA9IGRhdGEucmVzcG9uc2VIZWFkZXIgJiYgZGF0YS5yZXNwb25zZUhlYWRlci5zdGF0dXMgPyBkYXRhLnJlc3BvbnNlSGVhZGVyLnN0YXR1cyA6IDA7CiAgICAgICAgICAgICAgICAgICAgZG9jTGlzdCA9IGRhdGEucmVzcG9uc2UuZG9jczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAKCQkJCWlmKCBkb2NMaXN0ICYmIGRvY0xpc3QubGVuZ3RoID4gMCApewoJCQkJCWxldCBidWZmZXIgPSAnJzsKCQkJCQkKCQkJCQlmb3IobGV0IGkgPSAwO2kgPCBkb2NMaXN0Lmxlbmd0aDtpKyspewoJCQkJCQlpZiggaSA+IDAgKQoJCQkJCQkJYnVmZmVyICs9ICIsIjsKCQkJCQkJCgkJCQkJCWJ1ZmZlciArPSBkb2NMaXN0W2ldW3NvdXJjZVNvbHJJZEZpZWxkXSA/IGRvY0xpc3RbaV1bc291cmNlU29scklkRmllbGRdIDogZG9jTGlzdFtpXS5pZDsKCQkJCQkJCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXdEb2NEZXRhaWwgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImlkIjogdmFsaWRhdGVTb2xyVHlwZSArIGRvY1tzb3VyY2VTb2xySWRGaWVsZF0gKyBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnRpZCI6IGRvY1tzb3VyY2VTb2xySWRGaWVsZF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInF1ZXJ5X3R4dCI6IGRvY1t2YWxpZGF0ZVNvbHJGaWVsZF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVzdG5hbWU6IGRvY1sidGVzdG5hbWUiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZWlkOiBkb2NbImxhbmd1YWdlaWQiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2hhbm5lbGlkIjogZG9jWyJjaGFubmVsaWQiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKCQkJCQkJbmV3RG9jRGV0YWlsW3ZhbGlkYXRlU29sclR5cGVGaWVsZF0gPSB2YWxpZGF0ZVNvbHJUeXBlICsgIkRFVEFJTCI7CgkJCQkJCW5ld0RvY0RldGFpbFsic2VxdWVuY2UiXSA9IGk7CgkJCQkJCW5ld0RvY0RldGFpbFsiZG9jc2NvcmUiXSA9IGRvY0xpc3RbaV0uc2NvcmU7CgkJCQkJCWlmKCBpbmNsdWRlRGV0YWlsICkgZG9jRGV0YWlsTGlzdC5wdXNoKG5ld0RvY0RldGFpbCk7CgkJCQkJfQoJCQkJCQoJCQkJCW5ld0RvY1sidG9wZG9jIl0gPSBidWZmZXI7CgkJCQl9CgkJCQllbHNlCgkJCQkJbmV3RG9jWyJ0b3Bkb2MiXSA9ICdub25lJzsKCgkJCQlsZXQgdENhbGxiYWNrID0gdXBkYXRlQ2FsbGJhY2suYmluZCh7cXVlcnlEb2M6IGRvYyxoYXNNb3JlOiBoYXNNb3JlfSk7CgkJCQkKCQkJCWRvY0RldGFpbExpc3QucHVzaChuZXdEb2MpOwoJCQkJCgkJCQl2YXIgdCA9IENPTlRFWFQubGliLmh0dHAucmVxdWVzdCh7aG9zdG5hbWU6IHZhbGlkYXRlU29sckhvc3QscG9ydDogdmFsaWRhdGVTb2xyUG9ydCxwYXRoOiB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoLG1ldGhvZDogJ1BPU1QnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX0sIHRDYWxsYmFjayk7CgkJCQl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLndzbG9nKCJHb3QgZXJyb3I6ICIgKyBlLm1lc3NhZ2UpO30pOwoJCQkJdC53cml0ZShKU09OLnN0cmluZ2lmeShkb2NEZXRhaWxMaXN0KSk7CgkJCQl0LmVuZCgpOwoJCQkJCgkJICB9KTsKCQl9CgoJCWZ1bmN0aW9uIHZhbGlkYXRlUXVlcnkoZG9jLGhhc01vcmUpewoJCQlsZXQgdENhbGxiYWNrID0gcXVlcnlDYWxsYmFjay5iaW5kKHtxdWVyeURvYzogZG9jLGhhc01vcmU6IGhhc01vcmV9KTsKICAgICAgICAgICAgLy9jb25zb2xlLndzbG9nKGRvY1t2YWxpZGF0ZVNvbHJGaWVsZF0pOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYoIHNvdXJjZU1vZGUgPT0gJ0NPVkVPJyApewogICAgICAgICAgICAgICAgbGV0IHBheWxvYWQgID0ge3E6IGRvY1sicXVlcnlfdHh0Il0scGlwZWxpbmU6IHNvdXJjZVNvbHJDb2xsZWN0aW9uLHNvcnRDcml0ZXJpYTogInJlbGV2YW5jeSIsZmlyc3RSZXN1bHQ6IDAsbnVtYmVyT2ZSZXN1bHRzOiBiYXRjaFNpemV9OwogICAgICAgICAgICAgICAgLy9jb25zb2xlLndzbG9nKHRTb3VyY2VTb2xyUGF0aCk7CiAgICAgICAgICAgICAgICBsZXQgdCA9IENPTlRFWFQubGliLmh0dHBzLnJlcXVlc3Qoe2hvc3RuYW1lOiBzb3VyY2VTb2xySG9zdCxwb3J0OiBzb3VyY2VTb2xyUG9ydCxwYXRoOiBzb3VyY2VTb2xyUGF0aCxtZXRob2Q6ICdQT1NUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxBdXRob3JpemF0aW9uOiAiQmVhcmVyIGF1dGhrZXkifX0sIHRDYWxsYmFjayk7CiAgICAgICAgICAgICAgICB0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLndzbG9nKCJHb3QgZXJyb3I6ICIgKyBlLm1lc3NhZ2UpO30pOwogICAgICAgICAgICAgICAgdC53cml0ZShKU09OLnN0cmluZ2lmeShwYXlsb2FkKSk7CiAgICAgICAgICAgICAgICB0LmVuZCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgbGV0IHRTb3VyY2VTb2xyUGF0aCAgPSBzb3VyY2VTb2xyUGF0aCArICJxPXRpdGxlX3R4dDoiICsgZG9jWyJxdWVyeV90eHQiXTsKICAgICAgICAgICAgICAgIGNvbnNvbGUud3Nsb2coInNvbHIgcGF0aCIsdFNvdXJjZVNvbHJQYXRoKTsKICAgICAgICAgICAgICAgIGxldCB0ID0gQ09OVEVYVC5saWIuaHR0cC5yZXF1ZXN0KHtob3N0bmFtZTogc291cmNlU29sckhvc3QscG9ydDogc291cmNlU29sclBvcnQscGF0aDogZW5jb2RlVVJJKHRTb3VyY2VTb2xyUGF0aCksbWV0aG9kOiAnR0VUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319LCB0Q2FsbGJhY2spOwogICAgICAgICAgICAgICAgdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS53c2xvZygiR290IGVycm9yOiAiICsgZS5tZXNzYWdlKTt9KTsKICAgICAgICAgICAgICAgIHQuZW5kKCk7CiAgICAgICAgICAgIH0gICAgICAgICAKCQl9CgoJCWZ1bmN0aW9uIGxvYWRWYWxpZGF0aW9uRGF0YShjdXJzb3JNYXJrKXsKCQkJbGV0IHRDYWxsYmFjayA9IHZhbGlkYXRlQ2FsbGJhY2suYmluZCh7fSk7CgkJCQoJCQlsZXQgdFZhbGlkYXRlU29sclBhdGggPSB2YWxpZGF0ZVNvbHJQYXRoICsgIiZjdXJzb3JNYXJrPSIgKyBjdXJzb3JNYXJrOwoJCQljb25zb2xlLndzbG9nKCJTRUFSQ0hVUkwiLHRWYWxpZGF0ZVNvbHJQYXRoKTsKCQkJbGV0IHQgPSBDT05URVhULmxpYi5odHRwLnJlcXVlc3Qoe2hvc3RuYW1lOiB2YWxpZGF0ZVNvbHJIb3N0LHBvcnQ6IHZhbGlkYXRlU29sclBvcnQscGF0aDogdFZhbGlkYXRlU29sclBhdGgsbWV0aG9kOiAnR0VUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319LCB0Q2FsbGJhY2spOwoJCQl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLndzbG9nKCJHb3QgZXJyb3I6ICIgKyBlLm1lc3NhZ2UpO30pOwoJCQl0LmVuZCgpOwoJCX0KCgkJZnVuY3Rpb24gdHJ1bmNhdGVSZXN1bHRzKHdyaXRlTW9kZSxjYWxsYmFjayl7CgkJCWlmKCB3cml0ZU1vZGUgPT0gInRydW5jYXRlIiApewoJCQkJbGV0IHRDYWxsYmFjayA9IGNhbGxiYWNrLmJpbmQoe30pOwoJCQkJbGV0IHBheWxvYWQgPSB7ImRlbGV0ZSI6IHsicXVlcnkiOiAiY29udGVudHR5cGU6IiArIHZhbGlkYXRlU29sclR5cGV9fTsKCQkJCWxldCB0VmFsaWRhdGVTb2xyUGF0aCA9IHZhbGlkYXRlU29sclVwZGF0ZVBhdGggKyAiP2NvbW1pdD10cnVlIjsKCQkJCWxldCB0ID0gQ09OVEVYVC5saWIuaHR0cC5yZXF1ZXN0KHtob3N0bmFtZTogdmFsaWRhdGVTb2xySG9zdCxwb3J0OiB2YWxpZGF0ZVNvbHJQb3J0LHBhdGg6IHRWYWxpZGF0ZVNvbHJQYXRoLG1ldGhvZDogJ1BPU1QnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX0sIHRDYWxsYmFjayk7CgkJCQl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLndzbG9nKCJHb3QgZXJyb3I6ICIgKyBlLm1lc3NhZ2UpO30pOwoJCQkJdC53cml0ZShKU09OLnN0cmluZ2lmeShwYXlsb2FkKSk7CgkJCQl0LmVuZCgpOwoJCQl9CgkJCWVsc2UgewoJCQkJLy9xdWVydXkgdG8gZ2V0IHN0YXJ0aW5nIGtleQoJCQkJY2FsbGJhY2soKTsKCQkJfQoJCX0KCgkJZnVuY3Rpb24gZG9Db21taXQoKXsKCgkJCWlmKCBjb21tYW5kTGluZS5jYWxsYmFjayApewoJCQkJY29uc29sZS53c2xvZygiZG8gY29tcGxldGUgY2FsbGJhY2siKTsKCQkJCWNvbW1hbmRMaW5lLmNhbGxiYWNrKCk7CgkJCX0KCQkJZWxzZSB7CgkJCQljb25zb2xlLndzbG9nKCJkbyBjb21wbGV0ZSBjb21taXQiKTsKCQkJCXZhciB0Q2FsbGJhY2sgPSBjYWxsYmFjay5iaW5kKHt9KTsKCQkJCXZhciB0ID0gaHR0cC5nZXQoe2hvc3Q6IHZhbGlkYXRlU29sckhvc3QscG9ydDogdmFsaWRhdGVTb2xyUG9ydCxwYXRoOiB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoICsgIj9jb21taXQ9dHJ1ZSJ9LCB0Q2FsbGJhY2spOwoJCQl9CgkJfQoKCQlmdW5jdGlvbiBkb1dvcmsoKXsKCQkJbG9hZFZhbGlkYXRpb25EYXRhKGN1cnNvck1hcmspOwoJCX0KCQl0cnVuY2F0ZVJlc3VsdHMod3JpdGVNb2RlLGRvV29yayk7Cgl9CgoJCgpmdW5jdGlvbiBzdGFydFdvcmsob0NvbW1hbmRMaW5lKXsKCgl2YXIgZG9GaW5hbGx5ID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUud3Nsb2coImRvIGZpbmFsbHkiKTsKCQlsZXQgZmluYWxDQiA9IGZ1bmN0aW9uKCl7CgkJCWNvbnNvbGUud3Nsb2coImZpbmFsbHkgZG9uZSIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIG9Db21tYW5kTGluZS5jYWxsYmFjayApIG9Db21tYW5kTGluZS5jYWxsYmFjayhvQ29tbWFuZExpbmUucmVzdWx0Q29udGV4dCk7CgkJfQoJCXZhciBzb3VyY2VTb2xyQiA9IHt0ZXN0TmFtZTogb0NvbW1hbmRMaW5lLnRlc3ROYW1lID8gb0NvbW1hbmRMaW5lLnRlc3ROYW1lICA6ICJkZWZhdWx0Iixzb3VyY2VTb2xySG9zdDogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJIb3N0QiA/IG9Db21tYW5kTGluZS5zb3VyY2VTb2xySG9zdEIgOiBDT05URVhULlNPTFJIT1NULHNvdXJjZVNvbHJQb3J0OiBDT05URVhULlNPTFJQT1JULHNvdXJjZVNvbHJDb2xsZWN0aW9uOiBvQ29tbWFuZExpbmUuc291cmNlU29sckNvbGxlY3Rpb25CID8gb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJDb2xsZWN0aW9uQiA6IENPTlRFWFQuU09MUkNPTExFQ1RJT04sdmFsaWRhdGVTb2xyVHlwZToiQkVGT1JFIn07CgkJZm9yKGxldCBhIGluIG9Db21tYW5kTGluZSl7CgkJCXNvdXJjZVNvbHJCW2FdID0gb0NvbW1hbmRMaW5lW2FdOwoJCX0KICAgICAgICAgICAgICAgIHNvdXJjZVNvbHJCLmNhbGxiYWNrID0gZmluYWxDQjsKCgkJZXh0cmFjdFRlc3Qoc291cmNlU29sckIpOwoJfQoKCXZhciBzb3VyY2VTb2xyQSA9IHt0ZXN0TmFtZTogb0NvbW1hbmRMaW5lLnRlc3ROYW1lID8gb0NvbW1hbmRMaW5lLnRlc3ROYW1lICA6ICJkZWZhdWx0Iixzb3VyY2VTb2xySWRGaWVsZDogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJJZEZpZWxkID8gb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJJZEZpZWxkICA6ICJpZCIsc291cmNlTW9kZTogb0NvbW1hbmRMaW5lLnNvdXJjZU1vZGUgPyBvQ29tbWFuZExpbmUuc291cmNlTW9kZSAgOiAiU09MUiIsc291cmNlU29sckhvc3Q6IG9Db21tYW5kTGluZS5zb3VyY2VTb2xySG9zdEEgPyBvQ29tbWFuZExpbmUuc291cmNlU29sckhvc3RBIDogQ09OVEVYVC5TT0xSSE9TVCxzb3VyY2VTb2xyUG9ydDogQ09OVEVYVC5TT0xSUE9SVCxzb3VyY2VTb2xyQ29sbGVjdGlvbjogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJDb2xsZWN0aW9uQSA/IG9Db21tYW5kTGluZS5zb3VyY2VTb2xyQ29sbGVjdGlvbkEgOiBDT05URVhULlNPTFJDT0xMRUNUSU9OLHZhbGlkYXRlU29sclR5cGU6IkFGVEVSIn07Cglmb3IobGV0IGEgaW4gb0NvbW1hbmRMaW5lKXsKCQlzb3VyY2VTb2xyQVthXSA9IG9Db21tYW5kTGluZVthXTsKCX0KICAgICAgICBzb3VyY2VTb2xyQS5jYWxsYmFjayA9IGRvRmluYWxseTsKCglleHRyYWN0VGVzdChzb3VyY2VTb2xyQSk7CgoJCn0KCgpzdGFydFdvcmsob0NvbW1hbmRMaW5lKTsKCQp9","testextractscript_s":"testName=siemens sourceSolrCollectionB=validate sourceSolrCollectionA=validate","testinterpretscript":"ZnVuY3Rpb24oY29tbWFuZExpbmUpewogIGNvbnNvbGUubG9nKCJjb21tYW5kIixjb21tYW5kTGluZSk7CnZhciBwcm9maWxlTWFuYWdlciA9IGdldEN1cnJlbnRDb250ZXh0KCkuVUlQcm9maWxlTWFuYWdlcjsKICAgICAgICAgICAgCgkJCQlsZXQgc2VhcmNoQm94ID0gdGhpcy5zZWFyY2hCb3g7CgkJCQlsZXQgbWVzc2FnZUJveCA9IHRoaXMubWVzc2FnZUJveDsKCQkJCWxldCByZXN1bHRQYW5lbEEgPSB0aGlzLnJlc3VsdFBhbmVsQTsKCQkJCWxldCByZXN1bHRQYW5lbEIgPSB0aGlzLnJlc3VsdFBhbmVsQjsKCQkJCWxldCB0ZXN0ID0gdGhpcy50ZXN0OwoJCQkJCgkJCQlsZXQgYWxsRGF0YSA9IHt9OwoJCQkJCgkJCQlmdW5jdGlvbiBmaW5kTWF0Y2gocmVjLGtleTEsa2V5MixvdGhlckxpc3QpewoJCQkJCXZhciByZXN1bHQgPSAtMTsKCQkJCQlmb3IodmFyIGkgPSAwO2kgPCBvdGhlckxpc3QubGVuZ3RoO2krKyl7CgkJCQkJCWlmKCAocmVjW2tleTFdICYmIHJlY1trZXkxXSA9PT0gb3RoZXJMaXN0W2ldW2tleTFdKSB8fCAocmVjW2tleTJdICYmIHJlY1trZXkyXSA9PT0gb3RoZXJMaXN0W2ldW2tleTJdKSApewoJCQkJCQkJcmVzdWx0ID0gaTsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCgkJCQkJcmV0dXJuKCByZXN1bHQgKTsKCQkJCX0KCQkJCQoJCQkJbGV0IGNhbGxiYWNrID0gZnVuY3Rpb24oYXJncyxyZXNwKXsKCQkJCQljb25zb2xlLmxvZyhyZXNwKTsKCQkJCQlsZXQgcmVzdWx0UGFuZWxBID0gdGhpcy5yZXN1bHRQYW5lbEE7CgkJCQkJbGV0IHJlc3VsdFBhbmVsQiA9IHRoaXMucmVzdWx0UGFuZWxCOwoJCQkJCWxldCBpbnB1dCA9IHRoaXMuaW5wdXQ7CgkJCQkJbGV0IHNvdXJjZUEgPSAiQSI7CgkJCQkJbGV0IHNvdXJjZUIgPSAiQiI7CgkJCQkJbGV0IGNoYW5uZWwgPSB0aGlzLmNoYW5uZWw7CgkJCQkJCgkJCQkJV0lER0VURkFDVE9SWS5jbGVhckNoaWxkcmVuKHt3aWRnZXQ6IHJlc3VsdFBhbmVsQX0pOwoJCQkJCVdJREdFVEZBQ1RPUlkuY2xlYXJDaGlsZHJlbih7d2lkZ2V0OiByZXN1bHRQYW5lbEJ9KTsKCQkJCQkKCQkJCQlsZXQgZG9jcyA9IHJlc3AuaXRlbXM7CgkJCQkJCgkJCQkJaWYoIGRvY3MubGVuZ3RoID4gMCApewoJCQkJCQlhbGxEYXRhW3NvdXJjZUFdID0ge2RvY3M6IFtkb2NzWzBdXSxyZXN1bHRQYW5lbDogcmVzdWx0UGFuZWxBLHNvdXJjZTogc291cmNlQSxjaGFubmVsOiBjaGFubmVsfTsKCQkJCQkJYWxsRGF0YVtzb3VyY2VBXS5zb3VyY2UgPSBkb2NzWzBdLnNvdXJjZTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCWFsbERhdGFbc291cmNlQV0gPSB7ZG9jczogW10scmVzdWx0UGFuZWw6IHJlc3VsdFBhbmVsQSxzb3VyY2U6IHNvdXJjZUEsY2hhbm5lbDogY2hhbm5lbH07CgkJCQkJfQoJCQkJCQoJCQkJCWlmKCBkb2NzLmxlbmd0aCA+IDEpewoJCQkJCQlhbGxEYXRhW3NvdXJjZUJdID0ge2RvY3M6IFtkb2NzWzFdXSxyZXN1bHRQYW5lbDogcmVzdWx0UGFuZWxCLHNvdXJjZTogc291cmNlQixjaGFubmVsOiBjaGFubmVsfTsKCQkJCQkJYWxsRGF0YVtzb3VyY2VCXS5zb3VyY2UgPSBkb2NzWzFdLnNvdXJjZTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCWFsbERhdGFbc291cmNlQl0gPSB7ZG9jczogW10scmVzdWx0UGFuZWw6IHJlc3VsdFBhbmVsQixzb3VyY2U6IHNvdXJjZUIsY2hhbm5lbDogY2hhbm5lbH07CgkJCQkJfQoJCQkJCQoJCQkJCWxldCBkb25lID0gMDsKCgkJCQkJZm9yKHZhciBwIGluIGFsbERhdGEpewoJCQkJCQlpZiggYWxsRGF0YS5oYXNPd25Qcm9wZXJ0eShwKSApCgkJCQkJCQlkb25lKys7CgkJCQkJfQoJCQkJCQoJCQkJCWlmKCBkb25lID09IDIgKXsKCQkJCQkJbGV0IHNMaXN0ID0gW3NvdXJjZUEsc291cmNlQl07CgkJCQkJCWxldCBhTGlzdCA9IGFsbERhdGFbc291cmNlQV0uZG9jczsKCQkJCQkJbGV0IGJMaXN0ID0gYWxsRGF0YVtzb3VyY2VCXS5kb2NzOwoJCQkJCQkKCQkJCQkJbGV0IGxlZnRDb2xvciA9ICJncmVlbiI7CgkJCQkJCWxldCByaWdodENvbG9yID0gImdyZWVuIjsKCQkJCQkJbGV0IGFEb2NXaWRnZXQ7CgkJCQkJCWxldCBiRG9jV2lkZ2V0OwoJCQkJCQkKCQkJCQkJZm9yKGxldCBpIGluIGFMaXN0KXsKCQkJCQkJY29uc29sZS5sb2coImluZGV4IixpKTsKCQkJCQkJCQkKCQkJCQkJCWlmKCBpID09IDAgKXsKCQkJCQkJCQlhRG9jV2lkZ2V0ID0gV0lER0VURkFDVE9SWS5idWlsZFdpZGdldCh7d2hpY2g6ImRpdiIsaW5uZXJIVE1MOiBhTGlzdC5sZW5ndGggKyAoYUxpc3QubGVuZ3RoID4gMCA/ICIgZG9jcyBmb3VuZCBpbiAiICsgYWxsRGF0YVtzb3VyY2VBXS5zb3VyY2UgOiAiIikgfSk7CgkJCQkJCQkJY29uc29sZS5sb2coImFkb2MiLGFEb2NXaWRnZXQpOwoJCQkJCQkJCVdJREdFVEZBQ1RPUlkuYWRkV2lkZ2V0VG9Db250YWluZXIoe3BhcmVudDogYWxsRGF0YVtzb3VyY2VBXS5yZXN1bHRQYW5lbCxjaGlsZDogYURvY1dpZGdldH0pOwoJCQkJCQkJCQoJCQkJCQkJCWJEb2NXaWRnZXQgPSBXSURHRVRGQUNUT1JZLmJ1aWxkV2lkZ2V0KHt3aGljaDoiZGl2Iixpbm5lckhUTUw6IGJMaXN0Lmxlbmd0aCArIChiTGlzdC5sZW5ndGggPiAwID8gIiBkb2NzIGZvdW5kIGluICIgKyBhbGxEYXRhW3NvdXJjZUJdLnNvdXJjZSA6ICIiKSB9KTsKCQkJCQkJCQkKCQkJCQkJCQlXSURHRVRGQUNUT1JZLmFkZFdpZGdldFRvQ29udGFpbmVyKHtwYXJlbnQ6IGFsbERhdGFbc291cmNlQl0ucmVzdWx0UGFuZWwsY2hpbGQ6IGJEb2NXaWRnZXR9KTsKCQkJCQkJCX0KCQkJCQkJCQoJCQkJCQkJdmFyIG1hdGNoSW5kZXggPSBmaW5kTWF0Y2goYUxpc3RbaV0sImlkIiwiY3VzdG9tZXJfaWRfb3JkZXJfcHJvZHVjdF9pZCIsYkxpc3QpOwoJCQkJCQkJCgkJCQkJCQlpZiggbWF0Y2hJbmRleCA+IC0xICl7CgkJCQkJCQkJaWYoICBtYXRjaEluZGV4ICE9IGkgKXsKCQkJCQkJCQkJaWYoIG1hdGNoSW5kZXggPCBpICl7CgkJCQkJCQkJCQlsZWZ0Q29sb3IgPSAicmVkIjsKCQkJCQkJCQkJCXJpZ2h0Q29sb3IgPSAicmVkIjsKCQkJCQkJCQkJfQoJCQkJCQkJCQllbHNlIHsKCQkJCQkJCQkJCWxlZnRDb2xvciA9ICJncmVlbiI7CgkJCQkJCQkJCQlyaWdodENvbG9yID0gImdyZWVuIjsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCQllbHNlIHsKCQkJCQkJCQkJbGVmdENvbG9yID0gImdyZWVuIjsKCQkJCQkJCQkJcmlnaHRDb2xvciA9ICJncmVlbiI7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJZWxzZSB7CgkJCQkJCQkJbGVmdENvbG9yID0gInllbGxvdyI7CgkJCQkJCQkJcmlnaHRDb2xvciA9ICJ5ZWxsb3ciOwoJCQkJCQkJfQoJCQkJCQkJCQoJCQkJCQkJCgkJCQkJCQlsZXQgZW50cnlXaWRnZXRBID0gV0lER0VURkFDVE9SWS5idWlsZFdpZGdldCh7d2hpY2g6InVsIixpbm5lckhUTUw6ICJEb2N1bWVudCAiICsgaSxzdHlsZTogeyJiYWNrZ3JvdW5kLWNvbG9yIjogbGVmdENvbG9yfX0pOwoJCQkJCQkJV0lER0VURkFDVE9SWS5hZGRIYW5kbGVyKHt3aWRnZXQ6IGVudHJ5V2lkZ2V0QSxoYW5kbGVyOiBbe25hbWU6ICJjbGljayIsY2FsbGJhY2s6IGhhbmRsZUNsaWNrLmJpbmQoe2RvYzogYUxpc3RbaV0saW5wdXQ6IGlucHV0fSl9XX0pOwoJCQkJCQkJCQoJCQkJCQkJZm9yKGxldCBhIGluIGFMaXN0W2ldKXsKCQkJCQkJCQlpZiggIWEuc3RhcnRzV2l0aCgiXyIpICYmIFsiaWQiLCJjdXN0b21lcl9pZF9vcmRlcl9wcm9kdWN0X2lkIiwic2NvcmUiLCJxdGltZSIsInJvd2NvdW50IiwidG9wZG9jIiwicXVlcnlfdHh0Il0uaW5kZXhPZihhKSA+IC0xICl7CgkJCQkJCQkJCWxldCBhdHRyaWJ1dGVXaWRnZXQgPSBXSURHRVRGQUNUT1JZLmJ1aWxkV2lkZ2V0KHt3aGljaDoibGkiLGlubmVySFRNTDogYSArICI6ICIgKyBhTGlzdFtpXVthXX0pOwoJCQkJCQkJCQlXSURHRVRGQUNUT1JZLmFkZFdpZGdldFRvQ29udGFpbmVyKHtwYXJlbnQ6IGVudHJ5V2lkZ2V0QSxjaGlsZDogYXR0cmlidXRlV2lkZ2V0fSk7CgkJCQkJCQkJCQoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJCVdJREdFVEZBQ1RPUlkuYWRkV2lkZ2V0VG9Db250YWluZXIoe3BhcmVudDogYURvY1dpZGdldCxjaGlsZDogZW50cnlXaWRnZXRBfSk7CgkJCQkJCQkKCQkJCQkJCWlmKCBpIDwgYkxpc3QubGVuZ3RoICl7CgkJCQkJCQkJbGV0IGVudHJ5V2lkZ2V0QiA9IFdJREdFVEZBQ1RPUlkuYnVpbGRXaWRnZXQoe3doaWNoOiJ1bCIsaW5uZXJIVE1MOiAiRG9jdW1lbnQgIiArIGksc3R5bGU6IHsiYmFja2dyb3VuZC1jb2xvciI6IHJpZ2h0Q29sb3J9fSk7CgkJCQkJCQkJV0lER0VURkFDVE9SWS5hZGRIYW5kbGVyKHt3aWRnZXQ6IGVudHJ5V2lkZ2V0QixoYW5kbGVyOiBbe25hbWU6ICJjbGljayIsY2FsbGJhY2s6IGhhbmRsZUNsaWNrLmJpbmQoe2RvYzogYkxpc3RbaV0saW5wdXQ6IGlucHV0fSl9XX0pOwoJCQkJCQkJCQkJCgkJCQkJCQkJZm9yKGxldCBhIGluIGJMaXN0W2ldKXsKCQkJCQkJCQkJaWYoICFhLnN0YXJ0c1dpdGgoIl8iKSAmJiBbImlkIiwiY3VzdG9tZXJfaWRfb3JkZXJfcHJvZHVjdF9pZCIsInNjb3JlIiwicXRpbWUiLCJyb3djb3VudCIsInRvcGRvYyIsInF1ZXJ5X3R4dCJdLmluZGV4T2YoYSkgPiAtMSApewoJCQkJCQkJCQkJbGV0IGF0dHJpYnV0ZVdpZGdldCA9IFdJREdFVEZBQ1RPUlkuYnVpbGRXaWRnZXQoe3doaWNoOiJsaSIsaW5uZXJIVE1MOiBhICsgIjogIiArIGJMaXN0W2ldW2FdfSk7CgkJCQkJCQkJCQlXSURHRVRGQUNUT1JZLmFkZFdpZGdldFRvQ29udGFpbmVyKHtwYXJlbnQ6IGVudHJ5V2lkZ2V0QixjaGlsZDogYXR0cmlidXRlV2lkZ2V0fSk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQkJV0lER0VURkFDVE9SWS5hZGRXaWRnZXRUb0NvbnRhaW5lcih7cGFyZW50OiBiRG9jV2lkZ2V0LGNoaWxkOiBlbnRyeVdpZGdldEJ9KTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCQkKCQkJCQlnZXRDdXJyZW50Q29udGV4dCgpLnNldEJ1c3koKTsKCQkJCX0KCQkJCQoJCQkJY29uc29sZS5sb2coc2VhcmNoQm94LG1lc3NhZ2VCb3gscmVzdWx0UGFuZWxBLHJlc3VsdFBhbmVsQik7CgkJCQlsZXQgaW5wdXQgPSBzZWFyY2hCb3gudmFsdWU7CgkJCQlnZXRDdXJyZW50Q29udGV4dCgpLnNldEJ1c3kodHJ1ZSwiQ09NUEFSRSIpOwkKCQkJCWxldCBuZXdDYWxsYmFjayA9IGNhbGxiYWNrLmJpbmQoe3BhcmVudDogY29udGFpbmVyLHJlc3VsdFBhbmVsQTogcmVzdWx0UGFuZWxBLHJlc3VsdFBhbmVsQjogcmVzdWx0UGFuZWxCLGlucHV0OiBpbnB1dCxzZWFyY2hCb3g6IHNlYXJjaEJveCx0ZXN0OiB0ZXN0fSk7CgkJCQlnZXRDdXJyZW50Q29udGV4dCgpLkNhY2hlTWFuYWdlci5nZXREYXRhKHtjb250ZW50dHlwZTogIkNPTVBBUkUiLHdpbmRvdzogd2luZG93LHF1ZXJ5OnsgY29udGVudHR5cGU6ICJDT01QQVJFIixwYXJlbnRpZDogaW5wdXQsdGVzdG5hbWU6IHRlc3QudGVzdG5hbWV9LGNhbGxiYWNrOiBuZXdDYWxsYmFjayxub2NhY2hlOiB0cnVlfSk7CQkJCQoKfQ==","testsummaryscript":"ZnVuY3Rpb24oY29tbWFuZExpbmUpewp2YXIgYmF0Y2hTaXplID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2JhdGNoU2l6ZScpID8gY29tbWFuZExpbmVbJ2JhdGNoU2l6ZSddIDogMTA7CnZhciBzb3VyY2VSZXN1bHRTaXplID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVJlc3VsdFNpemUnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VSZXN1bHRTaXplJ10gOiAyOwp2YXIgdGVzdE5hbWUgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndGVzdE5hbWUnKSA/IGNvbW1hbmRMaW5lWyd0ZXN0TmFtZSddIDogJ2NvdmVvYmFzZSc7Cgp2YXIgc291cmNlU29sckhvc3QgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29sckhvc3QnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xySG9zdCddIDogQ09OVEVYVC5TT0xSSE9TVDsKdmFyIHNvdXJjZVNvbHJQb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJQb3J0JykgPyBjb21tYW5kTGluZVsnc291cmNlU29sclBvcnQnXSA6IENPTlRFWFQuU09MUlBPUlQ7CnZhciBzb3VyY2VTb2xyQ29sbGVjdGlvbiA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdzb3VyY2VTb2xyQ29sbGVjdGlvbicpID8gY29tbWFuZExpbmVbJ3NvdXJjZVNvbHJDb2xsZWN0aW9uJ10gOiBDT05URVhULlNPTFJDT0xMRUNUSU9OOwp2YXIgc291cmNlU29sclBhdGggPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29sclBhdGgnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xyUGF0aCddIDogIi9zb2xyLyIgKyBzb3VyY2VTb2xyQ29sbGVjdGlvbiArICIvc2VsZWN0P3d0PWpzb24mc29ydD1wYXJlbnRpZCBkZXNjLGNvbnRlbnR0eXBlIGRlc2Mmcm93cz0iICsgc291cmNlUmVzdWx0U2l6ZTsKdmFyIHNvdXJjZUhlYWRlclNvbHJQYXRoID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZUhlYWRlclNvbHJQYXRoJykgPyBjb21tYW5kTGluZVsnc291cmNlSGVhZGVyU29sclBhdGgnXSA6ICIvc29sci8iICsgc291cmNlU29sckNvbGxlY3Rpb24gKyAiL3NlbGVjdD93dD1qc29uJnJvd3M9MTAwMCZxPXRlc3RuYW1lOiIgKyB0ZXN0TmFtZTsKdmFyIHNvdXJjZVNvbHJJZEZpZWxkID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJJZEZpZWxkJykgPyBjb21tYW5kTGluZVsnc291cmNlU29scklkRmllbGQnXSA6ICJpZCI7CnZhciBzb3VyY2VGaWx0ZXJRdWVyeSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdzb3VyY2VGaWx0ZXJRdWVyeScpID8gY29tbWFuZExpbmVbJ3NvdXJjZUZpbHRlclF1ZXJ5J10gOiAiKGNvbnRlbnR0eXBlOkJFRk9SRSBPUiBjb250ZW50dHlwZTpBRlRFUikiOwp2YXIgc291cmNlSGVhZGVyRmlsdGVyUXVlcnkgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlSGVhZGVyRmlsdGVyUXVlcnknKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VIZWFkZXJGaWx0ZXJRdWVyeSddIDogIihjb250ZW50dHlwZTpKTVhRVUVSWUJFRk9SRSBPUiBjb250ZW50dHlwZTpKTVhRVUVSWUFGVEVSKSI7Cgp2YXIgdmFsaWRhdGVTb2xySG9zdCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJIb3N0JykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xySG9zdCddIDogQ09OVEVYVC5TT0xSSE9TVDsKdmFyIHZhbGlkYXRlU29sclBvcnQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xyUG9ydCcpID8gY29tbWFuZExpbmVbJ3ZhbGlkYXRlU29sclBvcnQnXSA6IENPTlRFWFQuU09MUlBPUlQ7CnZhciB2YWxpZGF0ZVNvbHJDb2xsZWN0aW9uID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sckNvbGxlY3Rpb24nKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJDb2xsZWN0aW9uJ10gOiBDT05URVhULlNPTFJDT0xMRUNUSU9OOwp2YXIgdmFsaWRhdGVTb2xyUGF0aCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJQYXRoJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyUGF0aCddIDogIi9zb2xyLyIgKyB2YWxpZGF0ZVNvbHJDb2xsZWN0aW9uICsgIi9zZWxlY3Q/cT0oY29udGVudHR5cGU6U0VBUkNIK0FORCt0ZXN0bmFtZToiICsgdGVzdE5hbWUgKyAiKSZ3dD1qc29uJnNvcnQ9aWQrZGVzYyZyb3dzPSIgKyBiYXRjaFNpemU7CnZhciB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sclVwZGF0ZVBhdGgnKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoJ10gOiAiL3NvbHIvdmFsaWRhdGUvdXBkYXRlIjsKdmFyIHZhbGlkYXRlU29sclR5cGVGaWVsZCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJUeXBlRmllbGQnKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJUeXBlRmllbGQnXSA6ICJjb250ZW50dHlwZSI7CnZhciB2YWxpZGF0ZVNvbHJUeXBlID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sclR5cGUnKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJUeXBlJ10gOiAiU1VNTUFSWSI7Cgp2YXIgbWlzc2luZ1NlbnRpbmFsID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ21pc3NpbmdTZW50aW5hbCcpID8gY29tbWFuZExpbmVbJ21pc3NpbmdTZW50aW5hbCddIDogLTEwMDA7Cgp2YXIgY3Vyc29yTWFyayA9ICIqIjsKdmFyIHF1ZXJ5Q291bnQgPSAwOwoKZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhyZXMpIHsKICB2YXIgc3RyID0gIiI7CiAgCiAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwogICAgICAgICAgICAgIAogICAgICAgIH0pOwoKICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAvL2NvbnNvbGUubG9nKHJlcy5maWVsZCk7CgkJLy9jb25zb2xlLmxvZyhzdHIpOwoJCQoJCWxldCBkYXRhID0gSlNPTi5wYXJzZShzdHIpOwoJCQoJCWlmKCBkYXRhLnJlc3BvbnNlICYmIGRhdGEucmVzcG9uc2UuZG9jcyApewogICAgICAgICAgICBxdWVyeUNvdW50ID0gZGF0YS5yZXNwb25zZS5kb2NzLmxlbmd0aDsKCgkJCWZvcihsZXQgZCBpbiBkYXRhLnJlc3BvbnNlLmRvY3MpewoJCQkJbGV0IGRvYyA9IGRhdGEucmVzcG9uc2UuZG9jc1tkXTsKCQkJCQoJCQkJdmFsaWRhdGVRdWVyeShkb2MsZGF0YS5uZXh0Q3Vyc29yTWFyayAmJiBjdXJzb3JNYXJrICE9IGRhdGEubmV4dEN1cnNvck1hcmsgJiYgcXVlcnlDb3VudCA9PSBiYXRjaFNpemUpOwoJCQl9CgkJfQoJCS8vY29uc29sZS5sb2coZGF0YSk7CgkJaWYoIGRhdGEubmV4dEN1cnNvck1hcmsgKXsKCQkJaWYoIGN1cnNvck1hcmsgIT0gZGF0YS5uZXh0Q3Vyc29yTWFyayApewkKCQkJCWN1cnNvck1hcmsgPSBkYXRhLm5leHRDdXJzb3JNYXJrOwoJCQl9CgkJCWVsc2UgewoJCQkJY29uc29sZS5sb2coImNvbXBsZXRlIik7CgkJCX0KCQl9CiAgfSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUNhbGxiYWNrKHJlcykgewogIHZhciBzdHIgPSAiIjsKICByZXMucXVlcnlEb2MgPSB0aGlzLnF1ZXJ5RG9jOwogIHZhciBoYXNNb3JlID0gdGhpcy5oYXNNb3JlOwogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzLnF1ZXJ5RG9jLmlkLCJVUERBVEUiLHN0cik7CiAgICAgICAgY29uc29sZS5sb2coImNoZWNraW5nIHF1ZXJ5IGNvdW50IixxdWVyeUNvdW50KTsKICAgICAgICBpZiggcXVlcnlDb3VudCA8PSAwICkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiY2FsbCBsb2FkIHN5YmMiLGhhc01vcmUpOwogICAgICAgICAgICBpZiggaGFzTW9yZSApCiAgICAgICAgICAgICAgICBsb2FkVmFsaWRhdGlvbkRhdGEoY3Vyc29yTWFyayk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGRvQ29tbWl0KCk7CiAgICAgICAgfQogIH0pOwp9CgpmdW5jdGlvbiBjYWxsYmFjayhyZXMpIHsKICB2YXIgc3RyID0gIiI7CiAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwogICAgICAgICAgICAgIAogICAgICAgIH0pOwoKICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zb2xlLmxvZygiQ09NTUlUIik7CiAgfSk7Cn0KCmZ1bmN0aW9uIGZpbmRNYXRjaChrZXksb3RoZXJMaXN0KXsKCXZhciByZXN1bHQgPSAtMTsKCWZvcih2YXIgaSA9IDA7aSA8IG90aGVyTGlzdC5sZW5ndGg7aSsrKXsKCQlpZigga2V5ID09PSBvdGhlckxpc3RbaV0gKXsKCQkJcmVzdWx0ID0gaTsKCQkJYnJlYWs7CgkJfQoJfQoKCXJldHVybiggcmVzdWx0ICk7Cn0KCmZ1bmN0aW9uIHF1ZXJ5Q2FsbGJhY2socmVzKSB7CiAgdmFyIHN0ciA9ICIiOwogIHJlcy5xdWVyeURvYyA9IHRoaXMucXVlcnlEb2M7CiAgdmFyIGhhc01vcmUgPSB0aGlzLmhhc01vcmU7CgogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMuZmllbGQpOwoJCWxldCBkb2MgPSByZXMucXVlcnlEb2M7CgkJLy9jb25zb2xlLmxvZyhyZXMucXVlcnlEb2Msc3RyKTsKCQlxdWVyeUNvdW50LS07CgkJbGV0IGRhdGEgPSBKU09OLnBhcnNlKHN0cik7CgkJbGV0IGRvY0RldGFpbExpc3QgPSBbXTsKCQkKCQlsZXQgbmV3RG9jID0geyJpZCI6IHZhbGlkYXRlU29sclR5cGUgKyBkb2MuaWQsInBhcmVudGlkIjogZG9jLmlkLCJxdWVyeV90eHQiOiBkb2NbInF1ZXJ5X3R4dCJdLHRlc3RuYW1lOiBkb2NbInRlc3RuYW1lIl0sbGFuZ3VhZ2VpZDogZG9jWyJsYW5ndWFnZWlkIl0sImNoYW5uZWxpZCI6IGRvY1siY2hhbm5lbGlkIl19OwoJCW5ld0RvY1t2YWxpZGF0ZVNvbHJUeXBlRmllbGRdID0gdmFsaWRhdGVTb2xyVHlwZTsKCQluZXdEb2NbInJvd2NvdW50Il0gPSBkYXRhLnJlc3BvbnNlICYmIGRhdGEucmVzcG9uc2UubnVtRm91bmQgPyBkYXRhLnJlc3BvbnNlLm51bUZvdW5kIDogMDsKCQkKCQlpZiggZGF0YS5yZXNwb25zZSAmJiBkYXRhLnJlc3BvbnNlLm51bUZvdW5kID4gMSApewoJCQlsZXQgYmVmb3JlUmVjID0gZGF0YS5yZXNwb25zZS5kb2NzWzBdOwoJCQlsZXQgYWZ0ZXJSZWMgPSBkYXRhLnJlc3BvbnNlLmRvY3NbMV07CgkJCQoJCQluZXdEb2NbInJvd2NvdW50YmVmb3JlIl0gPSBiZWZvcmVSZWNbJ3Jvd2NvdW50J107CgkJCW5ld0RvY1sicm93Y291bnRhZnRlciJdID0gYWZ0ZXJSZWNbJ3Jvd2NvdW50J107CgkJCgkJCW5ld0RvY1sicXRpbWViIl0gPSBiZWZvcmVSZWNbJ3F0aW1lJ107CgkJCW5ld0RvY1sicXRpbWVhIl0gPSBhZnRlclJlY1sncXRpbWUnXTsKCQkgICAgICAgIG5ld0RvY1sicXRpbWUiXSA9IGJlZm9yZVJlY1sncXRpbWUnXS0gYWZ0ZXJSZWNbJ3F0aW1lJ107CgkJCgkJCW5ld0RvY1sicm93Y291bnRiIl0gPSBiZWZvcmVSZWNbJ3Jvd2NvdW50J107CgkJCW5ld0RvY1sicm93Y291bnRhIl0gPSBhZnRlclJlY1sncm93Y291bnQnXTsKCQkgICAgICAgIG5ld0RvY1sicm93Y291bnQiXSA9IGJlZm9yZVJlY1sncm93Y291bnQnXS0gYWZ0ZXJSZWNbJ3Jvd2NvdW50J107CgkJCgkJCQoJCQlsZXQgY291bnRTY29yZSA9IGFmdGVyUmVjWyJyb3djb3VudCJdIC0gYmVmb3JlUmVjWyJyb3djb3VudCJdOwoJCgkJCWxldCBidWZmZXIgPSAnJzsKCQkJCgkJCWxldCBiZWZvcmVMaXN0ID0gYmVmb3JlUmVjWyJ0b3Bkb2MiXS5zcGxpdCgiLCIpOwoJCQlsZXQgYWZ0ZXJMaXN0ID0gYWZ0ZXJSZWNbInRvcGRvYyJdLnNwbGl0KCIsIik7CgkJCQoJCQluZXdEb2NbInRvcGRvY2JlZm9yZSJdID0gYmVmb3JlUmVjWyd0b3Bkb2MnXTsKCQkJbmV3RG9jWyJ0b3Bkb2NhZnRlciJdID0gYWZ0ZXJSZWNbJ3RvcGRvYyddOwoJCQkKCQkJbGV0IG1hdGNoU2NvcmVMaXN0ID0gW107CgkJCWxldCBtYXRjaFNjb3JlID0gMDsKCQkJZm9yKGxldCBpID0gMDtpIDwgYmVmb3JlTGlzdC5sZW5ndGg7aSsrKXsKCQkJCWxldCBpZHggPSBmaW5kTWF0Y2goYmVmb3JlTGlzdFtpXSxhZnRlckxpc3QpOwoJCQkJCgkJCQlpZiggaWR4ID4gLTEgKXsKCQkJCQltYXRjaFNjb3JlTGlzdC5wdXNoKGlkeCAtIGkpOwoJCQkJCW1hdGNoU2NvcmUgKz0gKGlkeCAtIGkpOwkJCQkJCgkJCQl9CgkJCQllbHNlIHsKCQkJCQltYXRjaFNjb3JlTGlzdC5wdXNoKG1pc3NpbmdTZW50aW5hbCk7CgkJCQkJbWF0Y2hTY29yZSArPSBtaXNzaW5nU2VudGluYWw7CgkJCQl9CgkJCX0KCQkJbmV3RG9jWyJtYXRjaHNjb3JlIl0gPSBtYXRjaFNjb3JlOwoJCQluZXdEb2NbIm1hdGNoc2NvcmVsaXN0Il0gPSBtYXRjaFNjb3JlTGlzdDsKCQkJbmV3RG9jWyJkaWZmZXJlbmNlc2NvcmUiXSA9IGNvdW50U2NvcmUgKyBtYXRjaFNjb3JlOwoJCQluZXdEb2NbImNvdW50c2NvcmUiXSA9IGNvdW50U2NvcmU7CgkJfQoJCWVsc2UgewoJCQluZXdEb2NbInBzY29yZSJdID0gJzAnOwoJCX0KCQlsZXQgdENhbGxiYWNrID0gdXBkYXRlQ2FsbGJhY2suYmluZCh7cXVlcnlEb2M6IGRvYyxoYXNNb3JlOiBoYXNNb3JlfSk7CgkJCgkJZG9jRGV0YWlsTGlzdC5wdXNoKG5ld0RvYyk7CgkJdmFyIGNvbmYgPSB7aG9zdG5hbWU6IHZhbGlkYXRlU29sckhvc3QscG9ydDogdmFsaWRhdGVTb2xyUG9ydCxwYXRoOiB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoLG1ldGhvZDogJ1BPU1QnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX07CgogICAgICAgICAgICAgICAgaWYoIENPTlRFWFQuQVVUSEtFWSApCiAgICAgICAgICAgICAgICAgICAgY29uZi5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmFzaWMgJyArIENPTlRFWFQuQVVUSEtFWTsKCgkJdmFyIHQgPSBDT05URVhULmxpYi5odHRwLnJlcXVlc3QoY29uZiwgdENhbGxiYWNrKTsKCQl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZygiR290IGVycm9yOiAiICsgZS5tZXNzYWdlKTt9KTsKCQl0LndyaXRlKEpTT04uc3RyaW5naWZ5KGRvY0RldGFpbExpc3QpKTsKCQl0LmVuZCgpOwogIH0pOwp9CgpmdW5jdGlvbiB2YWxpZGF0ZVF1ZXJ5KGRvYyxoYXNNb3JlKXsKCWxldCB0Q2FsbGJhY2sgPSBxdWVyeUNhbGxiYWNrLmJpbmQoe3F1ZXJ5RG9jOiBkb2MsaGFzTW9yZTogaGFzTW9yZX0pOwoJLy9jb25zb2xlLmxvZyhkb2MpOwoJbGV0IHRTb3VyY2VTb2xyUGF0aCA9IHNvdXJjZVNvbHJQYXRoICsgIiZmcT0iICsgc291cmNlRmlsdGVyUXVlcnkgKyAiJnE9cGFyZW50aWQ6IiArIGRvY1siaWQiXTsKCS8vY29uc29sZS5sb2codFNvdXJjZVNvbHJQYXRoKTsKCWxldCB0ID0gaHR0cC5yZXF1ZXN0KHtob3N0bmFtZTogc291cmNlU29sckhvc3QscG9ydDogc291cmNlU29sclBvcnQscGF0aDogZW5jb2RlVVJJKHRTb3VyY2VTb2xyUGF0aCksbWV0aG9kOiAnR0VUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319LCB0Q2FsbGJhY2spOwoJdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coIkdvdCBlcnJvcjogIiArIGUubWVzc2FnZSk7fSk7Cgl0LmVuZCgpOwp9CgpmdW5jdGlvbiBsb2FkVmFsaWRhdGlvbkRhdGEoY3Vyc29yTWFyayl7CglsZXQgdENhbGxiYWNrID0gdmFsaWRhdGVDYWxsYmFjay5iaW5kKHt9KTsKCQoJbGV0IHRWYWxpZGF0ZVNvbHJQYXRoID0gdmFsaWRhdGVTb2xyUGF0aCArICImY3Vyc29yTWFyaz0iICsgY3Vyc29yTWFyazsKCWNvbnNvbGUubG9nKHRWYWxpZGF0ZVNvbHJQYXRoKTsKICAgICAgICAgdmFyIGNvbmYgPSB7aG9zdG5hbWU6IHZhbGlkYXRlU29sckhvc3QscG9ydDogdmFsaWRhdGVTb2xyUG9ydCxwYXRoOiB0VmFsaWRhdGVTb2xyUGF0aCxtZXRob2Q6ICdHRVQnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX07CgogICAgICAgICAgICAgICAgaWYoIENPTlRFWFQuQVVUSEtFWSApCiAgICAgICAgICAgICAgICAgICAgY29uZi5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmFzaWMgJyArIENPTlRFWFQuQVVUSEtFWTsKCWxldCB0ID0gaHR0cC5yZXF1ZXN0KGNvbmYsIHRDYWxsYmFjayk7Cgl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZygiR290IGVycm9yOiAiICsgZS5tZXNzYWdlKTt9KTsKCXQuZW5kKCk7Cn0KCmZ1bmN0aW9uIGRvQ29tbWl0KCl7CiAgICBpZiggY29tbWFuZExpbmUuY2FsbGJhY2sgKXsKICAgICAgICBjb25zb2xlLmxvZygiZG8gY29tcGxldGUgY2FsbGJhY2siKTsKICAgICAgICBjb21tYW5kTGluZS5jYWxsYmFjaygpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgdmFyIHRDYWxsYmFjayA9IGNhbGxiYWNrLmJpbmQoe30pOwp2YXIgdFZhbGlkYXRlU29sclBhdGggPSB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoICsgIj9jb21taXQ9dHJ1ZSI7Cgp2YXIgY29uZiA9IHtob3N0bmFtZTogdmFsaWRhdGVTb2xySG9zdCxwb3J0OiB2YWxpZGF0ZVNvbHJQb3J0LHBhdGg6IHRWYWxpZGF0ZVNvbHJQYXRoLG1ldGhvZDogJ0dFVCcsaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9fTsKCiAgICAgICAgICAgICAgICBpZiggQ09OVEVYVC5BVVRIS0VZICkKICAgICAgICAgICAgICAgICAgICBjb25mLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCYXNpYyAnICsgQ09OVEVYVC5BVVRIS0VZOwogICAgICAgIHZhciB0ID0gaHR0cC5nZXQoY29uZiwgdENhbGxiYWNrKTsKICAgIH0KfQoKbG9hZFZhbGlkYXRpb25EYXRhKGN1cnNvck1hcmspOwoKfQ==","testsummaryscript_s":"testName=siemens","id":"TEST1598994530023","contenttype":"TEST","crawldate":"2020-09-04T01:23:49.327Z","testcopyscript":"ZnVuY3Rpb24ob0NvbW1hbmRMaW5lKXsKCmZ1bmN0aW9uIGNsb25lQ29sbGVjdGlvbihjb21tYW5kTGluZSl7CnZhciBiYXRjaFNpemUgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnYmF0Y2hTaXplJykgPyBjb21tYW5kTGluZVsnYmF0Y2hTaXplJ10gOiAxMDAwOwp2YXIgc291cmNlU29scklkRmllbGQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29scklkRmllbGQnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xySWRGaWVsZCddIDogImlkIjsKdmFyIHNvdXJjZVNvbHJRdWVyeSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdzb3VyY2VTb2xyUXVlcnknKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xyUXVlcnknXSA6ICIqOioiOwp2YXIgbG9hZERhdGEgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnbG9hZERhdGEnKSA/IGNvbW1hbmRMaW5lWydsb2FkRGF0YSddID09ICd0cnVlJyA6IHRydWU7CnZhciB0ZXN0TmFtZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd0ZXN0TmFtZScpID8gY29tbWFuZExpbmVbJ3Rlc3ROYW1lJ10gOiAnZGVmYXVsdCc7Cgp2YXIgc291cmNlU29sckhvc3QgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29sckhvc3QnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xySG9zdCddIDogInNvbHJzZXJ2ZXIiOwp2YXIgc291cmNlU29sclBvcnQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlU29sclBvcnQnKSA/IGNvbW1hbmRMaW5lWydzb3VyY2VTb2xyUG9ydCddIDogODE4MDsKdmFyIHNvdXJjZVNvbHJDb2xsZWN0aW9uID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3NvdXJjZVNvbHJDb2xsZWN0aW9uJykgPyBjb21tYW5kTGluZVsnc291cmNlU29sckNvbGxlY3Rpb24nXSA6ICdjb2xsZWN0aW9uMSc7CnZhciBzb3VyY2VTb2xyUGF0aCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdzb3VyY2VTb2xyUGF0aCcpID8gY29tbWFuZExpbmVbJ3NvdXJjZVNvbHJQYXRoJ10gOiAiL3NvbHIvIiArIHNvdXJjZVNvbHJDb2xsZWN0aW9uICsgIi9zZWxlY3Q/d3Q9anNvbiZzb3J0PSIgKyBzb3VyY2VTb2xySWRGaWVsZCArICIrYXNjJnJvd3M9IiArIGJhdGNoU2l6ZSArICImcT0iICsgc291cmNlU29sclF1ZXJ5OwoKdmFyIGRlc3RpbmF0aW9uU29sckhvc3QgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnZGVzdGluYXRpb25Tb2xySG9zdCcpID8gY29tbWFuZExpbmVbJ2Rlc3RpbmF0aW9uU29sckhvc3QnXSA6ICJzb2xyc2VydmVyMiI7CnZhciBkZXN0aW5hdGlvblNvbHJQb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2Rlc3RpbmF0aW9uU29sclBvcnQnKSA/IGNvbW1hbmRMaW5lWydkZXN0aW5hdGlvblNvbHJQb3J0J10gOiA4MTgwOwp2YXIgZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbiA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdkZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uJykgPyBjb21tYW5kTGluZVsnZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbiddIDogJ2NvbGxlY3Rpb24xJzsKdmFyIGRlc3RpbmF0aW9uU29sclVwZGF0ZVBhdGggPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgnZGVzdGluYXRpb25Tb2xyVXBkYXRlUGF0aCcpID8gY29tbWFuZExpbmVbJ2Rlc3RpbmF0aW9uU29sclVwZGF0ZVBhdGgnXSA6ICIvc29sci8iICsgZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbiArICIvdXBkYXRlIjsKdmFyIGRlc3RpbmF0aW9uU29sckNvbmZpZ1NldCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdkZXN0aW5hdGlvblNvbHJDb25maWdTZXQnKSA/IGNvbW1hbmRMaW5lWydkZXN0aW5hdGlvblNvbHJDb25maWdTZXQnXSA6IGZhbHNlOwp2YXIgZG9TeW5jTG9hZCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCdkb1N5bmNMb2FkJykgPyBjb21tYW5kTGluZVsnZG9TeW5jTG9hZCddIDogdHJ1ZTsKdmFyIGpteEluZm9Qb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ2pteEluZm9Qb3J0JykgPyBjb21tYW5kTGluZVsnam14SW5mb1BvcnQnXSA6IDE4MTgwOwp2YXIgdmFsaWRhdGVTb2xySG9zdCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJIb3N0JykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xySG9zdCddIDogImxvY2FsaG9zdCI7CnZhciB2YWxpZGF0ZVNvbHJQb3J0ID0gY29tbWFuZExpbmUuaGFzT3duUHJvcGVydHkoJ3ZhbGlkYXRlU29sclBvcnQnKSA/IGNvbW1hbmRMaW5lWyd2YWxpZGF0ZVNvbHJQb3J0J10gOiA4OTgzOwp2YXIgdmFsaWRhdGVTb2xyVXBkYXRlUGF0aCA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyVXBkYXRlUGF0aCddIDogIi9zb2xyL3ZhbGlkYXRlL3VwZGF0ZSI7CnZhciB2YWxpZGF0ZVNvbHJUeXBlRmllbGQgPSBjb21tYW5kTGluZS5oYXNPd25Qcm9wZXJ0eSgndmFsaWRhdGVTb2xyVHlwZUZpZWxkJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyVHlwZUZpZWxkJ10gOiAiY29udGVudHR5cGUiOwp2YXIgdmFsaWRhdGVTb2xyVHlwZSA9IGNvbW1hbmRMaW5lLmhhc093blByb3BlcnR5KCd2YWxpZGF0ZVNvbHJUeXBlJykgPyBjb21tYW5kTGluZVsndmFsaWRhdGVTb2xyVHlwZSddIDogIk1FTU9SWVVQREFURSI7Cgp2YXIgY3Vyc29yTWFyayA9ICIqIjsKCnZhciBqbXhDbGllbnQgPSBmYWxzZTsKCmlmKCBqbXhJbmZvUG9ydCA+IDAgKXsKCWxldCBjbGllbnQgPSBqbXguY3JlYXRlQ2xpZW50KHsKCSAgaG9zdDogZGVzdGluYXRpb25Tb2xySG9zdCwgLy8gb3B0aW9uYWwKCSAgcG9ydDogam14SW5mb1BvcnQKCX0pOwoJIAoJY2xpZW50LmNvbm5lY3QoKTsKCWNsaWVudC5vbigiY29ubmVjdCIsIGZ1bmN0aW9uKCkgewogCQlqbXhDbGllbnQgPSBjbGllbnQ7CiAJIAljb25zb2xlLmxvZygiSk1YIiwiUkVBRFkiKTsKCX0pOwp9CgpmdW5jdGlvbiBnZXRKTVhTdGF0cyhqbXhDbGllbnQsdGVzdE5hbWUsd2hpY2gsY2FsbGJhY2spewogIGxldCByZXN1bHQgPSB7dGVzdG5hbWU6IHRlc3ROYW1lfTsKICAgIHJlc3VsdFt2YWxpZGF0ZVNvbHJUeXBlRmllbGRdID0gdmFsaWRhdGVTb2xyVHlwZTsKICAgIAogICAgaWYoIGpteENsaWVudCApewogICAgam14Q2xpZW50LmdldEF0dHJpYnV0ZSgiamF2YS5sYW5nOnR5cGU9R2FyYmFnZUNvbGxlY3RvcixuYW1lPUcxIFlvdW5nIEdlbmVyYXRpb24iLCAiQ29sbGVjdGlvbkNvdW50IiwgZnVuY3Rpb24oZGF0YSkgewogICAgICAvL2NvbnNvbGUubG9nKCJNaW5vciBDb2xsZWN0aW9uQ291bnQiLGRhdGEudG9TdHJpbmcoKSk7CiAgICAgIHRoaXMucmVzdWx0Lm1pbm9yY29sbGVjdGlvbmNvdW50X3MgPSBkYXRhLnRvU3RyaW5nKCk7CiAgICAgIC8vY2FsbGJhY2socmVzdWx0KTsKICAgICAgam14Q2xpZW50LmdldEF0dHJpYnV0ZSgiamF2YS5sYW5nOnR5cGU9R2FyYmFnZUNvbGxlY3RvcixuYW1lPUcxIFlvdW5nIEdlbmVyYXRpb24iLCAiQ29sbGVjdGlvblRpbWUiLCBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCJNaW5vciBDb2xsZWN0aW9uVGltZSIsZGF0YS50b1N0cmluZygpKTsKICAgICAgICAgIHRoaXMucmVzdWx0Lm1pbm9yY29sbGVjdGlvbnRpbWVfcyA9IGRhdGEudG9TdHJpbmcoKTsKICAgICAgICAgIC8vY2FsbGJhY2socmVzdWx0KTsKICAgICAgICAgIGpteENsaWVudC5nZXRBdHRyaWJ1dGUoImphdmEubGFuZzp0eXBlPUdhcmJhZ2VDb2xsZWN0b3IsbmFtZT1HMSBPbGQgR2VuZXJhdGlvbiIsICJDb2xsZWN0aW9uQ291bnQiLCBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIk1ham9yIENvbGxlY3Rpb25Db3VudCIsZGF0YS50b1N0cmluZygpKTsKICAgICAgICAgICAgdGhpcy5yZXN1bHQubWFqb3Jjb2xsZWN0aW9uY291bnRfcyA9IGRhdGEudG9TdHJpbmcoKTsKICAgICAgICAgICAgLy9jYWxsYmFjayhyZXN1bHQpOwogICAgICAgICAgICBqbXhDbGllbnQuZ2V0QXR0cmlidXRlKCJqYXZhLmxhbmc6dHlwZT1HYXJiYWdlQ29sbGVjdG9yLG5hbWU9RzEgT2xkIEdlbmVyYXRpb24iLCAiQ29sbGVjdGlvblRpbWUiLCBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiTWFqb3IgQ29sbGVjdGlvblRpbWUiLGRhdGEudG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQubWFqb3Jjb2xsZWN0aW9udGltZV9zID0gZGF0YS50b1N0cmluZygpOwoKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJKTVhSRVNVTFQiLHRoaXMucmVzdWx0KTsKICAgICAgICAgICAgICAvL2NhbGxiYWNrKHRoaXMucmVzdWx0KTsKICAgICAgICAgICAgICBqbXhDbGllbnQuZ2V0QXR0cmlidXRlKCJqYXZhLmxhbmc6dHlwZT1NZW1vcnlQb29sLG5hbWU9RzEgRWRlbiBTcGFjZSIsICJVc2FnZSIsIGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgIGxldCB1c2VkID0gZGF0YS5nZXRTeW5jKCd1c2VkJyk7CiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5lZGVudXNhZ2VfcyA9IHVzZWQubG9uZ1ZhbHVlOwoKICAgICAgICAgICAgICAgIGpteENsaWVudC5nZXRBdHRyaWJ1dGUoImphdmEubGFuZzp0eXBlPU1lbW9yeVBvb2wsbmFtZT1HMSBPbGQgR2VuIiwgIlVzYWdlIiwgZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICBsZXQgdXNlZCA9IGRhdGEuZ2V0U3luYygndXNlZCcpOwogICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5vbGRnZW51c2FnZV9zID0gdXNlZC5sb25nVmFsdWU7CgogICAgICAgICAgICAgICAgICBjYWxsYmFjayh0aGlzLnJlc3VsdCk7CiAgICAgICAgICAgICAgICB9LmJpbmQoe3Jlc3VsdDogdGhpcy5yZXN1bHR9KSk7CiAgICAgICAgICAgICAgfS5iaW5kKHtyZXN1bHQ6IHRoaXMucmVzdWx0fSkpOwogICAgICAgICAgICB9LmJpbmQoe3Jlc3VsdDogdGhpcy5yZXN1bHR9KSk7CiAgICAgICAgICB9LmJpbmQoe3Jlc3VsdDogdGhpcy5yZXN1bHR9KSk7CiAgICAgICAgfS5iaW5kKHtyZXN1bHQ6IHRoaXMucmVzdWx0fSkpOwogICAgfS5iaW5kKHtyZXN1bHQ6IHJlc3VsdH0pKTsgIAogIH0KCiAgcmV0dXJuKCByZXN1bHQgKTsKfQoKZnVuY3Rpb24gcXVlcnlDYWxsYmFjayhyZXMpIHsKICBsZXQgc3RyID0gIiI7CiAgCQkKICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CiAgICAgICAgICAgICAgCiAgICAgICAgfSk7CgogIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgIC8vY29uc29sZS5sb2cocmVzLmZpZWxkKTsKCQkvL2NvbnNvbGUubG9nKHN0cik7CgkJCgkJbGV0IGRhdGEgPSBKU09OLnBhcnNlKHN0cik7CgkJCgkJaWYoIGRhdGEucmVzcG9uc2UgJiYgZGF0YS5yZXNwb25zZS5kb2NzICl7CgkJCWZvcihsZXQgZCBpbiBkYXRhLnJlc3BvbnNlLmRvY3MpewoJCQkJbGV0IGRvYyA9IGRhdGEucmVzcG9uc2UuZG9jc1tkXTsKCQkJCWZvciggbGV0IHAgaW4gZG9jKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kb2NbIlByU3RhdHVzIl0gPSA0OwoJCQkJCWlmKCBkb2MuaGFzT3duUHJvcGVydHkocCkgKXsKCQkJCQkJaWYoIHAgPT09ICdfdmVyc2lvbl8nIHx8IHAgPT09ICdzY29yZScgKXsKCQkJCQkJCQoJCQkJCQkJZGVsZXRlIGRvY1twXTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCQoJCQl9CgkJCQoJCQljb3B5RG9jdW1lbnRzKGRhdGEucmVzcG9uc2UuZG9jcyxkYXRhKTsKCQl9CgkJLy9jb25zb2xlLmxvZyhkYXRhKTsKCQlpZiggIWRvU3luY0xvYWQgKXsKCQkJaWYoIGRhdGEubmV4dEN1cnNvck1hcmsgKXsKCQkJCWlmKCBjdXJzb3JNYXJrICE9IGRhdGEubmV4dEN1cnNvck1hcmsgKXsJCgkJCQkJY3Vyc29yTWFyayA9IGRhdGEubmV4dEN1cnNvck1hcms7CgkJCQkJbG9hZFF1ZXJ5QmF0Y2goY3Vyc29yTWFyaykKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWNvbnNvbGUubG9nKCJjb21wbGV0ZSIpOwoJCQkJCWRvQ29tbWl0KCk7CgkJCQl9CgkJCX0KCQl9CiAgfSk7Cn0KCmZ1bmN0aW9uIHN0YXRzVXBkYXRlQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBkYXRhID0gdGhpcy5kYXRhOwogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coIlNUQVRTVVBEQVRFIixzdHIpOwogIH0pOwp9CgoKZnVuY3Rpb24gc2F2ZVVwZGF0ZVN0YXRzKHJlc3BEYXRhLHF1ZXJ5RGF0YSl7CglsZXQgY2IgPSBmdW5jdGlvbihqbXhEYXRhKXsKCQlsZXQgdENhbGxiYWNrID0gc3RhdHNVcGRhdGVDYWxsYmFjay5iaW5kKHtyZXNwRGF0YTogcmVzcERhdGEsZGF0YTogcXVlcnlEYXRhfSk7CgoJCWpteERhdGEucXRpbWUgPSByZXNwRGF0YS5yZXNwb25zZUhlYWRlci5RVGltZTsKCgkJbGV0IGRvY3MgPSBbIGpteERhdGEgXTsKCQljb25zb2xlLmxvZyhkb2NzKTsKCQlsZXQgdCA9IGh0dHAucmVxdWVzdCh7aG9zdG5hbWU6IHZhbGlkYXRlU29sckhvc3QscG9ydDogdmFsaWRhdGVTb2xyUG9ydCxwYXRoOiB2YWxpZGF0ZVNvbHJVcGRhdGVQYXRoLG1ldGhvZDogJ1BPU1QnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX0sIHRDYWxsYmFjayk7CgkJdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coIkdvdCBlcnJvcjogIiArIGUubWVzc2FnZSk7fSk7CgkJdC53cml0ZShKU09OLnN0cmluZ2lmeShkb2NzKSk7CgkJdC5lbmQoKTsKCX07CgoJZ2V0Sk1YU3RhdHMoam14Q2xpZW50LHRlc3ROYW1lLCJBTEwiLGNiKTsKfQoKZnVuY3Rpb24gdXBkYXRlQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBkYXRhID0gdGhpcy5kYXRhOwogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coIlVQREFURSIsc3RyKTsKICAgICAgICBsZXQgcmVzcERhdGEgPSBKU09OLnBhcnNlKHN0cik7CiAgICAgICAgc2F2ZVVwZGF0ZVN0YXRzKHJlc3BEYXRhLGRhdGEpOwoKICAgICAgICBpZiggZG9TeW5jTG9hZCApewogICAgICAgIAlpZiggZGF0YS5uZXh0Q3Vyc29yTWFyayApewoJCQkJaWYoIGN1cnNvck1hcmsgIT0gZGF0YS5uZXh0Q3Vyc29yTWFyayApewkKCQkJCQljdXJzb3JNYXJrID0gZGF0YS5uZXh0Q3Vyc29yTWFyazsKCQkJCQlsb2FkUXVlcnlCYXRjaChjdXJzb3JNYXJrKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWNvbnNvbGUubG9nKCJjb21wbGV0ZSIpOwoJCQkJCWRvQ29tbWl0KCk7CgkJCQl9CgkJCX0KICAgICAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIGNvbW1pdENhbGxiYWNrKHJlcykgewogIGxldCBzdHIgPSAiIjsKICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CiAgICAgICAgICAgICAgCiAgICAgICAgfSk7CgogIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJDT01NSVQiKTsKCQkKCQlyZWxvYWRDb2xsZWN0aW9uKGRlc3RpbmF0aW9uU29sckNvbGxlY3Rpb24sdHJ1ZSk7CgoJCWlmKCBjb21tYW5kTGluZS5jYWxsYmFjayApewoJCQljb21tYW5kTGluZS5jYWxsYmFjaygpOwoJCX0KICB9KTsKfQoKZnVuY3Rpb24gY29weURvY3VtZW50cyhkb2NzLGRhdGEpewoJbGV0IHRDYWxsYmFjayA9IHVwZGF0ZUNhbGxiYWNrLmJpbmQoe2RhdGE6IGRhdGF9KTsKCQljb25zb2xlLmxvZyhkZXN0aW5hdGlvblNvbHJIb3N0LGRlc3RpbmF0aW9uU29sclVwZGF0ZVBhdGgpOwoJbGV0IHQgPSBodHRwLnJlcXVlc3Qoe2hvc3RuYW1lOiBkZXN0aW5hdGlvblNvbHJIb3N0LHBvcnQ6IGRlc3RpbmF0aW9uU29sclBvcnQscGF0aDogZGVzdGluYXRpb25Tb2xyVXBkYXRlUGF0aCxtZXRob2Q6ICdQT1NUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319LCB0Q2FsbGJhY2spOwoJdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coIkdvdCBlcnJvcjogIiArIGUubWVzc2FnZSk7fSk7Cgl0LndyaXRlKEpTT04uc3RyaW5naWZ5KGRvY3MpKTsKCXQuZW5kKCk7Cn0KCmZ1bmN0aW9uIGxvYWRRdWVyeUJhdGNoKGN1cnNvck1hcmspewoJaWYoIGxvYWREYXRhICl7CgkJY29uc29sZS5sb2coIkRPSU5HV09SSyIpOwoJCWxldCB0Q2FsbGJhY2sgPSBxdWVyeUNhbGxiYWNrLmJpbmQoe30pOwoJCQoJCWxldCB0U291cmNlU29sclBhdGggPSBzb3VyY2VTb2xyUGF0aCArICImY3Vyc29yTWFyaz0iICsgY3Vyc29yTWFyazsKCQlsZXQgdCA9IGh0dHAucmVxdWVzdCh7aG9zdG5hbWU6IHNvdXJjZVNvbHJIb3N0LHBvcnQ6IHNvdXJjZVNvbHJQb3J0LHBhdGg6IHRTb3VyY2VTb2xyUGF0aCxtZXRob2Q6ICdHRVQnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX0sIHRDYWxsYmFjayk7CgkJdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coIkdvdCBlcnJvcjogIiArIGUubWVzc2FnZSk7fSk7CgkJdC5lbmQoKTsKCX0KCWVsc2UgewoJCWNvbnNvbGUubG9nKCJOT1RET0lOR1dPUksiKTsKCX0KfQoKZnVuY3Rpb24gZG9Db21taXQoKXsKCWxldCB0Q2FsbGJhY2sgPSBjb21taXRDYWxsYmFjay5iaW5kKHt9KTsKCWxldCB0ID0gaHR0cC5nZXQoe2hvc3Q6IGRlc3RpbmF0aW9uU29sckhvc3QscG9ydDogZGVzdGluYXRpb25Tb2xyUG9ydCxwYXRoOiBkZXN0aW5hdGlvblNvbHJVcGRhdGVQYXRoICsgIj9zdHJlYW0uYm9keT08Y29tbWl0Lz4ifSwgdENhbGxiYWNrKTsKfQoKZnVuY3Rpb24gcmVsb2FkQ29sbGVjdGlvbkNhbGxiYWNrKHJlcykgewogIGxldCBzdHIgPSAiIjsKICBsZXQgY29sbGVjdGlvbiA9IHRoaXMuY29sbGVjdGlvbjsKICBsZXQgZG9Ob3RoaW5nID0gdGhpcy5kb05vdGhpbmc7CiAgCiAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgICAgICAgc3RyICs9IGNodW5rOwogICAgICAgICAgICAgIAogICAgICAgIH0pOwoKICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zb2xlLmxvZygiUkVMT0FEQ09MTEVDVElPTiIpOwoJCWlmKCAhZG9Ob3RoaW5nICkKCQkJbG9hZFF1ZXJ5QmF0Y2goY3Vyc29yTWFyayk7CgkJCQogIH0pOwp9CgoKZnVuY3Rpb24gcmVsb2FkQ29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSxkb05vdGhpbmcpewoJbGV0IHRDYWxsYmFjayA9IHJlbG9hZENvbGxlY3Rpb25DYWxsYmFjay5iaW5kKHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZSxkb05vdGhpbmc6IGRvTm90aGluZ30pOwoJbGV0IHRTb2xyUGF0aCA9ICIvc29sci9hZG1pbi9jb2xsZWN0aW9ucz9fPTE1NzIyNzkyMzI2NTYmYWN0aW9uPVJFTE9BRCZuYW1lPSIgKyBjb2xsZWN0aW9uTmFtZSArICImd3Q9anNvbiI7CgkKCWxldCB0ID0gaHR0cC5nZXQoe2hvc3Q6IGRlc3RpbmF0aW9uU29sckhvc3QscG9ydDogZGVzdGluYXRpb25Tb2xyUG9ydCxjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZSxwYXRoOiB0U29sclBhdGh9LCB0Q2FsbGJhY2spOwp9CgoKZnVuY3Rpb24gY29weUZpZWxkc0NhbGxiYWNrKHJlcykgewogIGxldCBzdHIgPSAiIjsKICBsZXQgY29sbGVjdGlvbiA9IHRoaXMuY29sbGVjdGlvbjsKICAKICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CiAgICAgICAgICAgICAgCiAgICAgICAgfSk7CgogIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJDT1BZRklFTERTIik7CgkJbGV0IHJlc3AgPSBKU09OLnBhcnNlKHN0cik7CgkJCgkJaWYoIHJlc3AuZmllbGRzICl7CgkJCWZpZWxkTGlzdCA9IHJlc3AuZmllbGRzOwoJCQlmb3IobGV0IGkgaW4gcmVzcC5maWVsZHMpewoJCQkJbGV0IHRGaWVsZCA9IHJlc3AuZmllbGRzW2ldOwoJCQkJY29weUZpZWxkVG9EZXN0aW5hdGlvbihjb2xsZWN0aW9uLHRGaWVsZCk7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCWNvbnNvbGUubG9nKCJOT0ZJRUxEUyIscmVzcCk7CgkJfQoJCQogIH0pOwp9Cgp2YXIgZmllbGRMaXN0Q291bnRlciA9IDA7CnZhciBmaWVsZExpc3QgPSBmYWxzZTsKZnVuY3Rpb24gY29weUZpZWxkcyhjb2xsZWN0aW9uTmFtZSl7Cgljb25zb2xlLmxvZygiTE9BRElOR0ZJRUxEUyIsY29sbGVjdGlvbk5hbWUpOwoJbGV0IHRDYWxsYmFjayA9IGNvcHlGaWVsZHNDYWxsYmFjay5iaW5kKHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZX0pOwoJbGV0IHQgPSBodHRwLmdldCh7aG9zdDogc291cmNlU29sckhvc3QscG9ydDogc291cmNlU29sclBvcnQsY29sbGVjdGlvbjogZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbixwYXRoOiAiL3NvbHIvIiArIHNvdXJjZVNvbHJDb2xsZWN0aW9uICsgIi9zY2hlbWEvZmllbGRzP3d0PWpzb24ifSwgdENhbGxiYWNrKTsKfQoKZnVuY3Rpb24gY29weUZpZWxkVG9EZXN0aW5hdGlvbkNhbGxiYWNrKHJlcykgewogIGxldCBzdHIgPSAiIjsKICBsZXQgY29sbGVjdGlvbiA9IHRoaXMuY29sbGVjdGlvbjsKICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CiAgICAgICAgICAgICAgCiAgICAgICAgfSk7CgogIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgIAoJCWZpZWxkTGlzdENvdW50ZXIrKzsKCQkKCQlpZiggZmllbGRMaXN0Q291bnRlciA9PSBmaWVsZExpc3QubGVuZ3RoICl7CgkJCWNvbnNvbGUubG9nKCJBRERMQVNURklFTEQiLHN0cik7CgkJCXJlbG9hZENvbGxlY3Rpb24oY29sbGVjdGlvbik7CgkJfQoJCWVsc2UgewoJCQljb25zb2xlLmxvZygiQURERklFTEQiLHN0cik7CgkJfQoJCQogIH0pOwp9CgpmdW5jdGlvbiBjb3B5RmllbGRUb0Rlc3RpbmF0aW9uKGNvbGxlY3Rpb25OYW1lLHBheWxvYWQpewoJbGV0IHRDYWxsYmFjayA9IGNvcHlGaWVsZFRvRGVzdGluYXRpb25DYWxsYmFjay5iaW5kKHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZSxmaWVsZDogcGF5bG9hZH0pOwoJbGV0IHREZXN0aW5hdGlvblNvbHJQYXRoID0gIi9zb2xyLyIgKyBjb2xsZWN0aW9uTmFtZSArICIvc2NoZW1hIjsKCWxldCB0ID0gaHR0cC5yZXF1ZXN0KHtob3N0bmFtZTogZGVzdGluYXRpb25Tb2xySG9zdCxwb3J0OiBkZXN0aW5hdGlvblNvbHJQb3J0LHBhdGg6IHREZXN0aW5hdGlvblNvbHJQYXRoLG1ldGhvZDogJ1BPU1QnLGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfX0sIHRDYWxsYmFjayk7Cgl0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZygiR290IGVycm9yOiAiICsgZS5tZXNzYWdlKTt9KTsKCXQud3JpdGUoSlNPTi5zdHJpbmdpZnkoeyJhZGQtZmllbGQiOiBwYXlsb2FkIH0pKTsKCXQuZW5kKCk7Cn0KCmZ1bmN0aW9uIGNvcHlGaWVsZFR5cGVUb0Rlc3RpbmF0aW9uQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBjb2xsZWN0aW9uID0gdGhpcy5jb2xsZWN0aW9uOwogIAogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZmllbGRUeXBlTGlzdENvdW50ZXIrKzsKCQkKCQlpZiggZmllbGRUeXBlTGlzdENvdW50ZXIgPT0gZmllbGRUeXBlTGlzdC5sZW5ndGggKXsKCQkJY29uc29sZS5sb2coIkFERExBU1RGSUVMRFRZUEUiLHN0cik7CgkJCgkJCWNvcHlGaWVsZHMoY29sbGVjdGlvbik7CgkJfQoJCWVsc2UgewoJCQljb25zb2xlLmxvZygiQURERklFTERUWVBFIixzdHIpOwoJCX0KICB9KTsKfQoKZnVuY3Rpb24gY29weUZpZWxkVHlwZVRvRGVzdGluYXRpb24oY29sbGVjdGlvbk5hbWUscGF5bG9hZCl7CglsZXQgdENhbGxiYWNrID0gY29weUZpZWxkVHlwZVRvRGVzdGluYXRpb25DYWxsYmFjay5iaW5kKHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZSxmaWVsZFR5cGU6IHBheWxvYWR9KTsKCWxldCB0RGVzdGluYXRpb25Tb2xyUGF0aCA9ICIvc29sci8iICsgY29sbGVjdGlvbk5hbWUgKyAiL3NjaGVtYSI7CglsZXQgdCA9IGh0dHAucmVxdWVzdCh7aG9zdG5hbWU6IGRlc3RpbmF0aW9uU29sckhvc3QscG9ydDogZGVzdGluYXRpb25Tb2xyUG9ydCxwYXRoOiB0RGVzdGluYXRpb25Tb2xyUGF0aCxtZXRob2Q6ICdQT1NUJyxoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ319LCB0Q2FsbGJhY2spOwoJdC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coIkdvdCBlcnJvcjogIiArIGUubWVzc2FnZSk7fSk7Cgl0LndyaXRlKEpTT04uc3RyaW5naWZ5KHsiYWRkLWZpZWxkLXR5cGUiOiBwYXlsb2FkIH0pKTsKCXQuZW5kKCk7Cn0KCnZhciBmaWVsZFR5cGVMaXN0Q291bnRlciA9IDA7CnZhciBmaWVsZFR5cGVMaXN0ID0gZmFsc2U7CmZ1bmN0aW9uIGNvcHlGaWVsZFR5cGVzQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBjb2xsZWN0aW9uID0gdGhpcy5jb2xsZWN0aW9uOwogIAogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coIkNPUFlGSUVMRFRZUEVTIik7CgkJbGV0IHJlc3AgPSBKU09OLnBhcnNlKHN0cik7CgkJCgkJaWYoIHJlc3AuZmllbGRUeXBlcyApewoJCQlmaWVsZFR5cGVMaXN0ID0gcmVzcC5maWVsZFR5cGVzOwoJCQlmb3IobGV0IGkgaW4gcmVzcC5maWVsZFR5cGVzKXsKCQkJCWxldCB0RmllbGRUeXBlID0gcmVzcC5maWVsZFR5cGVzW2ldOwoJCQkJY29weUZpZWxkVHlwZVRvRGVzdGluYXRpb24oY29sbGVjdGlvbix0RmllbGRUeXBlKTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJY29uc29sZS5sb2coIk5PRklFTERUWVBFUyIsc3RyKTsKCQl9CiAgfSk7Cn0KCmZ1bmN0aW9uIGNvcHlGaWVsZFR5cGVzKGNvbGxlY3Rpb25OYW1lKXsKCWxldCB0Q2FsbGJhY2sgPSBjb3B5RmllbGRUeXBlc0NhbGxiYWNrLmJpbmQoe2NvbGxlY3Rpb246IGNvbGxlY3Rpb25OYW1lfSk7CglsZXQgdCA9IGh0dHAuZ2V0KHtob3N0OiBzb3VyY2VTb2xySG9zdCxwb3J0OiBzb3VyY2VTb2xyUG9ydCxjb2xsZWN0aW9uOiBkZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uLHBhdGg6ICIvc29sci8iICsgc291cmNlU29sckNvbGxlY3Rpb24gKyAiL3NjaGVtYS9maWVsZHR5cGVzP3d0PWpzb24ifSwgdENhbGxiYWNrKTsKfQoKZnVuY3Rpb24gYnVpbGRDb2xsZWN0aW9uQ2FsbGJhY2socmVzKSB7CiAgbGV0IHN0ciA9ICIiOwogIGxldCBjb2xsZWN0aW9uID0gdGhpcy5jb2xsZWN0aW9uOwogIAogIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICAgIHN0ciArPSBjaHVuazsKICAgICAgICAgICAgICAKICAgICAgICB9KTsKCiAgcmVzLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coIkJVSUxEQ09MTEVDVElPTiIsc3RyKTsKCQkKCQlpZiggZGVzdGluYXRpb25Tb2xyQ29uZmlnU2V0ICl7CgkJCWxvYWRRdWVyeUJhdGNoKGN1cnNvck1hcmspOwoJCX0KCQllbHNlIHsKCQkJY29weUZpZWxkVHlwZXMoY29sbGVjdGlvbik7CgkJfQogIH0pOwp9CgpmdW5jdGlvbiBidWlsZENvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpewoJbGV0IHRDYWxsYmFjayA9IGJ1aWxkQ29sbGVjdGlvbkNhbGxiYWNrLmJpbmQoe2NvbGxlY3Rpb246IGNvbGxlY3Rpb25OYW1lfSk7CgkKCWxldCB0U29sclBhdGggPSAiL3NvbHIvYWRtaW4vY29sbGVjdGlvbnM/Xz0xNTcyMjc5MjMyNjU2JmFjdGlvbj1DUkVBVEUmYXV0b0FkZFJlcGxpY2FzPWZhbHNlJm1heFNoYXJkc1Blck5vZGU9MSZuYW1lPSIgKyBjb2xsZWN0aW9uTmFtZSArICImbnVtU2hhcmRzPTEmcmVwbGljYXRpb25GYWN0b3I9MSZyb3V0ZXIubmFtZT1jb21wb3NpdGVJZCZ3dD1qc29uIjsKCQoJaWYoIGRlc3RpbmF0aW9uU29sckNvbmZpZ1NldCApewoJCXRTb2xyUGF0aCArPSAiJmNvbGxlY3Rpb24uY29uZmlnTmFtZT0iICsgZGVzdGluYXRpb25Tb2xyQ29uZmlnU2V0OwoJfQoJCglsZXQgdCA9IGh0dHAuZ2V0KHtob3N0OiBkZXN0aW5hdGlvblNvbHJIb3N0LHBvcnQ6IGRlc3RpbmF0aW9uU29sclBvcnQsY29sbGVjdGlvbjogZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbixwYXRoOiB0U29sclBhdGh9LCB0Q2FsbGJhY2spOwp9CgoKZnVuY3Rpb24gZGVzdGluYXRpb25DaGVja0NhbGxiYWNrKHJlcykgewogIGxldCBzdHIgPSAiIjsKICBsZXQgY29sbGVjdGlvbiA9IHRoaXMuY29sbGVjdGlvbjsKICAKICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKICAgICAgICAgICAgICBzdHIgKz0gY2h1bms7CiAgICAgICAgICAgICAgCiAgICAgICAgfSk7CgogIHJlcy5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJDTFVTVEVSU1RBVFVTIik7CgkJbGV0IGNsdXN0ZXJTdGF0dXMgPSBKU09OLnBhcnNlKHN0cik7CgkJCgkJaWYoIGNsdXN0ZXJTdGF0dXMuY2x1c3RlciAgJiYgY2x1c3RlclN0YXR1cy5jbHVzdGVyLmNvbGxlY3Rpb25zICYmIGNsdXN0ZXJTdGF0dXMuY2x1c3Rlci5jb2xsZWN0aW9uc1tjb2xsZWN0aW9uXSApewoJCQlsb2FkUXVlcnlCYXRjaChjdXJzb3JNYXJrKTsKCQl9CgkJZWxzZSB7CgkJCS8vY3JlYXRlIGNvbGxlY3Rpb24KCQkJY29uc29sZS5sb2coIk5PIERFU1RJTkFUSU9OIixjb2xsZWN0aW9uKTsKCQkJYnVpbGRDb2xsZWN0aW9uKGNvbGxlY3Rpb24pOwoJCX0KICB9KTsKfQoKCgoKZnVuY3Rpb24gY2hlY2tEZXN0aW5hdGlvbigpewoJaWYoICFjb21tYW5kTGluZS5kaXNhYmxlZCApewoJCWxldCB0Q2FsbGJhY2sgPSBkZXN0aW5hdGlvbkNoZWNrQ2FsbGJhY2suYmluZCh7Y29sbGVjdGlvbjogZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbn0pOwoJCWxldCB0ID0gaHR0cC5nZXQoe2hvc3Q6IGRlc3RpbmF0aW9uU29sckhvc3QscG9ydDogZGVzdGluYXRpb25Tb2xyUG9ydCxjb2xsZWN0aW9uOiBkZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uLHBhdGg6ICIvc29sci9hZG1pbi9jb2xsZWN0aW9ucz9hY3Rpb249Q0xVU1RFUlNUQVRVUyZ3dD1qc29uIn0sIHRDYWxsYmFjayk7Cgl9CgllbHNlIHsKCQlpZiggY29tbWFuZExpbmUuY2FsbGJhY2sgKXsKCQkJY29uc29sZS5sb2coIkNBTExCQUNLIiwiZG9pbmcgY2FsbGJhY2siKTsKCQkJY29tbWFuZExpbmUuY2FsbGJhY2soKTsKCQl9CgkJZWxzZSB7CgkJCWNvbnNvbGUubG9nKCJDT01QTEVURSIsIm5vIGNhbGxiYWNrIGFuZCBkaXNhYmxlZCIpOwoJCX0KCX0KfQoKCmNoZWNrRGVzdGluYXRpb24oKTsKCgp9CgoKbGV0IHNvdXJjZVNvbHJBID0ge3Rlc3ROYW1lOiBvQ29tbWFuZExpbmUudGVzdE5hbWUgPyBvQ29tbWFuZExpbmUudGVzdE5hbWUgOiJkZW5vcm0iLAoJCQkJCXNvdXJjZVNvbHJIb3N0OiBvQ29tbWFuZExpbmUuc291cmNlU29sckhvc3RBID8gb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJIb3N0QSA6ImMzLnNvbHJjbG91ZC5zZXJ2aWNlLmludHJhYm8xLmNvbnN1bC5jc256b28uY29tIiwKCQkJCQlzb3VyY2VTb2xyUG9ydDogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJQb3J0QSA/IG9Db21tYW5kTGluZS5zb3VyY2VTb2xyUG9ydEEgOiI4MTgwIiwKCQkJCQlzb3VyY2VTb2xyQ29sbGVjdGlvbjogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJDb2xsZWN0aW9uQSA/IG9Db21tYW5kTGluZS5zb3VyY2VTb2xyQ29sbGVjdGlvbkEgOiJkZW5vcm1fdXMiLAoJCQkJCXNvdXJjZVNvbHJJZEZpZWxkOiBvQ29tbWFuZExpbmUuc291cmNlU29scklkRmllbGQgPyBvQ29tbWFuZExpbmUuc291cmNlU29scklkRmllbGQgOiJQclNLVU9wdGlvbkNvbWJpbmF0aW9uSUQiLAoJCQkJCWRlc3RpbmF0aW9uU29sckhvc3Q6IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJIb3N0QSA/IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJIb3N0QSA6InNvbHJjbG91ZGMyM24xLmhvc3QuYm8xLmNzbnpvby5jb20iLAoJCQkJCWRlc3RpbmF0aW9uU29sclBvcnQ6IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJQb3J0QSA/IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJQb3J0QSA6IjgxODAiLAoJCQkJCWRlc3RpbmF0aW9uU29sckNvbGxlY3Rpb246IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uQSA/IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uQSA6ICJkZW5vcm1fdXNfYmVmb3JlIiwKCQkJCQlkaXNhYmxlZDogdHJ1ZSwKCQkJCQlqbXhJbmZvUG9ydDogMTgxODAsCiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVTb2xyVHlwZTogIk1FTU9SWVVQREFURUJFRk9SRSJ9OwoKZm9yKGxldCBhIGluIG9Db21tYW5kTGluZSl7Cglzb3VyY2VTb2xyQVthXSA9IG9Db21tYW5kTGluZVthXTsKfQoKbGV0IGNhbGxiYWNrID0gZnVuY3Rpb24oKXsKCWNvbnNvbGUubG9nKCJjb21wbGV0ZWQgZnJvbSBzdGFydGluZyBhZnRlciIpOwogICAgbGV0IG9Db21tYW5kTGluZSA9IHRoaXMub0NvbW1hbmRMaW5lOwoKCWxldCBzb3VyY2VTb2xyQiA9IHt0ZXN0TmFtZTogb0NvbW1hbmRMaW5lLnRlc3ROYW1lID8gb0NvbW1hbmRMaW5lLnRlc3ROYW1lIDoiZGVub3JtIiwKCQkJCQlzb3VyY2VTb2xySG9zdDogb0NvbW1hbmRMaW5lLmRlc3RpbmF0aW9uU29sckhvc3RBID8gb0NvbW1hbmRMaW5lLmRlc3RpbmF0aW9uU29sckhvc3RBIDoic29scmNsb3VkYzIzbjEuaG9zdC5ibzEuY3Nuem9vLmNvbSIsCgkJCQkJc291cmNlU29sclBvcnQ6IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJQb3J0QSA/IG9Db21tYW5kTGluZS5kZXN0aW5hdGlvblNvbHJQb3J0QSA6IjgxODAiLAoJCQkJCXNvdXJjZVNvbHJDb2xsZWN0aW9uOiBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbkEgPyBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbkEgOiJkZW5vcm1fdXNfYmVmb3JlIiwKCQkJCQlzb3VyY2VTb2xySWRGaWVsZDogb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJJZEZpZWxkID8gb0NvbW1hbmRMaW5lLnNvdXJjZVNvbHJJZEZpZWxkIDoiUHJTS1VPcHRpb25Db21iaW5hdGlvbklEIiwKCQkJCQlkZXN0aW5hdGlvblNvbHJIb3N0OiBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xySG9zdEIgPyBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xySG9zdEIgOiJzb2xyY2xvdWRjMjNuMi5ob3N0LmJvMS5jc256b28uY29tIiwKCQkJCQlkZXN0aW5hdGlvblNvbHJQb3J0OiBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyUG9ydEIgPyBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyUG9ydEIgOiI4MTgwIiwKCQkJCQlkZXN0aW5hdGlvblNvbHJDb2xsZWN0aW9uOiBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbkIgPyBvQ29tbWFuZExpbmUuZGVzdGluYXRpb25Tb2xyQ29sbGVjdGlvbkIgOiJkZW5vcm1fdXNfYWZ0ZXIiLAogICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlU29sclR5cGU6ICJNRU1PUllVUERBVEVBRlRFUiJ9OwoJCglmb3IobGV0IGEgaW4gb0NvbW1hbmRMaW5lKXsKCQlzb3VyY2VTb2xyQlthXSA9IG9Db21tYW5kTGluZVthXTsKCX0KCgljbG9uZUNvbGxlY3Rpb24oc291cmNlU29sckIpOwoKfS5iaW5kKHtvQ29tbWFuZExpbmU6IG9Db21tYW5kTGluZX0pOwoKc291cmNlU29sckEuY2FsbGJhY2sgPSBjYWxsYmFjazsKCmNsb25lQ29sbGVjdGlvbihzb3VyY2VTb2xyQSk7CgoKCn0="}